<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html">
        <link rel="prefetch" href="../../_static/logo-square.svg" as="image">

    <!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>click.core - Click Extra</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80449d92" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     Click Extra works fine, but is <em>maintained by only one person</em> üò∂‚Äçüå´Ô∏è.<br/>You can help if you <strong><a class='reference external' href='https://github.com/sponsors/kdeldycke'>purchase business support ü§ù</a></strong> or <strong><a class='reference external' href='https://github.com/sponsors/kdeldycke'>sponsor the project ü´∂</a></strong>. 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Click Extra</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo-square.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-download" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M2.75 14A1.75 1.75 0 0 1 1 12.25v-2.5a.75.75 0 0 1 1.5 0v2.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-2.5a.75.75 0 0 1 1.5 0v2.5A1.75 1.75 0 0 1 13.25 14Z"></path><path d="M7.25 7.689V2a.75.75 0 0 1 1.5 0v5.689l1.97-1.969a.749.749 0 1 1 1.06 1.06l-3.25 3.25a.749.749 0 0 1-1.06 0L4.22 6.78a.749.749 0 1 1 1.06-1.06l1.97 1.969Z"></path></svg> Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-mortar-board" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.693 1.066a.747.747 0 0 1 .614 0l7.25 3.25a.75.75 0 0 1 0 1.368L13 6.831v2.794c0 1.024-.81 1.749-1.66 2.173-.893.447-2.075.702-3.34.702-.278 0-.55-.012-.816-.036a.75.75 0 0 1 .133-1.494c.22.02.45.03.683.03 1.082 0 2.025-.221 2.67-.543.69-.345.83-.682.83-.832V7.503L8.307 8.934a.747.747 0 0 1-.614 0L4 7.28v1.663c.296.105.575.275.812.512.438.438.688 1.059.688 1.796v3a.75.75 0 0 1-.75.75h-3a.75.75 0 0 1-.75-.75v-3c0-.737.25-1.358.688-1.796.237-.237.516-.407.812-.512V6.606L.443 5.684a.75.75 0 0 1 0-1.368ZM2.583 5 8 7.428 13.416 5 8 2.572ZM2.5 11.25v2.25H4v-2.25c0-.388-.125-.611-.25-.735a.697.697 0 0 0-.5-.203.707.707 0 0 0-.5.203c-.125.124-.25.347-.25.735Z"></path></svg> Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../commands.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-command-palette" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="m6.354 8.04-4.773 4.773a.75.75 0 1 0 1.061 1.06L7.945 8.57a.75.75 0 0 0 0-1.06L2.642 2.206a.75.75 0 0 0-1.06 1.061L6.353 8.04ZM8.75 11.5a.75.75 0 0 0 0 1.5h5.5a.75.75 0 0 0 0-1.5h-5.5Z"></path></svg> Commands &amp; groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-sliders" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M15 2.75a.75.75 0 0 1-.75.75h-4a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 .75.75Zm-8.5.75v1.25a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-1.5 0V2H1.75a.75.75 0 0 0 0 1.5H6.5Zm1.25 5.25a.75.75 0 0 0 0-1.5h-6a.75.75 0 0 0 0 1.5h6ZM15 8a.75.75 0 0 1-.75.75H11.5V10a.75.75 0 1 1-1.5 0V6a.75.75 0 0 1 1.5 0v1.25h2.75A.75.75 0 0 1 15 8Zm-9 5.25v-2a.75.75 0 0 0-1.5 0v1.25H1.75a.75.75 0 0 0 0 1.5H4.5v1.25a.75.75 0 0 0 1.5 0v-2Zm9 0a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h6a.75.75 0 0 1 .75.75Z"></path></svg> Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../colorize.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-paintbrush" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M11.134 1.535c.7-.509 1.416-.942 2.076-1.155.649-.21 1.463-.267 2.069.34.603.601.568 1.411.368 2.07-.202.668-.624 1.39-1.125 2.096-1.011 1.424-2.496 2.987-3.775 4.249-1.098 1.084-2.132 1.839-3.04 2.3a3.744 3.744 0 0 1-1.055 3.217c-.431.431-1.065.691-1.657.861-.614.177-1.294.287-1.914.357A21.151 21.151 0 0 1 .797 16H.743l.007-.75H.749L.742 16a.75.75 0 0 1-.743-.742l.743-.008-.742.007v-.054a21.25 21.25 0 0 1 .13-2.284c.067-.647.187-1.287.358-1.914.17-.591.43-1.226.86-1.657a3.746 3.746 0 0 1 3.227-1.054c.466-.893 1.225-1.907 2.314-2.982 1.271-1.255 2.833-2.75 4.245-3.777ZM1.62 13.089c-.051.464-.086.929-.104 1.395.466-.018.932-.053 1.396-.104a10.511 10.511 0 0 0 1.668-.309c.526-.151.856-.325 1.011-.48a2.25 2.25 0 1 0-3.182-3.182c-.155.155-.329.485-.48 1.01a10.515 10.515 0 0 0-.309 1.67Zm10.396-10.34c-1.224.89-2.605 2.189-3.822 3.384l1.718 1.718c1.21-1.205 2.51-2.597 3.387-3.833.47-.662.78-1.227.912-1.662.134-.444.032-.551.009-.575h-.001V1.78c-.014-.014-.113-.113-.548.027-.432.14-.995.462-1.655.942Zm-4.832 7.266-.001.001a9.859 9.859 0 0 0 1.63-1.142L7.155 7.216a9.7 9.7 0 0 0-1.161 1.607c.482.302.889.71 1.19 1.192Z"></path></svg> Colored help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../logging.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-log" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M5 8.25a.75.75 0 0 1 .75-.75h4a.75.75 0 0 1 0 1.5h-4A.75.75 0 0 1 5 8.25ZM4 10.5A.75.75 0 0 0 4 12h4a.75.75 0 0 0 0-1.5H4Z"></path><path d="M13-.005c1.654 0 3 1.328 3 3 0 .982-.338 1.933-.783 2.818-.443.879-1.028 1.758-1.582 2.588l-.011.017c-.568.853-1.104 1.659-1.501 2.446-.398.789-.623 1.494-.623 2.136a1.5 1.5 0 1 0 2.333-1.248.75.75 0 0 1 .834-1.246A3 3 0 0 1 13 16H3a3 3 0 0 1-3-3c0-1.582.891-3.135 1.777-4.506.209-.322.418-.637.623-.946.473-.709.923-1.386 1.287-2.048H2.51c-.576 0-1.381-.133-1.907-.783A2.68 2.68 0 0 1 0 2.995a3 3 0 0 1 3-3Zm0 1.5a1.5 1.5 0 0 0-1.5 1.5c0 .476.223.834.667 1.132A.75.75 0 0 1 11.75 5.5H5.368c-.467 1.003-1.141 2.015-1.773 2.963-.192.289-.381.571-.558.845C2.13 10.711 1.5 11.916 1.5 13A1.5 1.5 0 0 0 3 14.5h7.401A2.989 2.989 0 0 1 10 13c0-.979.338-1.928.784-2.812.441-.874 1.023-1.748 1.575-2.576l.017-.026c.568-.853 1.103-1.658 1.501-2.448.398-.79.623-1.497.623-2.143 0-.838-.669-1.5-1.5-1.5Zm-10 0a1.5 1.5 0 0 0-1.5 1.5c0 .321.1.569.27.778.097.12.325.227.74.227h7.674A2.737 2.737 0 0 1 10 2.995c0-.546.146-1.059.401-1.5Z"></path></svg> Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../table.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-table" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path></svg> Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../version.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-versions" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.75 14A1.75 1.75 0 0 1 6 12.25v-8.5C6 2.784 6.784 2 7.75 2h6.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14Zm-.25-1.75c0 .138.112.25.25.25h6.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-6.5a.25.25 0 0 0-.25.25ZM4.9 3.508a.75.75 0 0 1-.274 1.025.249.249 0 0 0-.126.217v6.5c0 .09.048.173.126.217a.75.75 0 0 1-.752 1.298A1.75 1.75 0 0 1 3 11.25v-6.5c0-.649.353-1.214.874-1.516a.75.75 0 0 1 1.025.274ZM1.625 5.533h.001a.249.249 0 0 0-.126.217v4.5c0 .09.048.173.126.217a.75.75 0 0 1-.752 1.298A1.748 1.748 0 0 1 0 10.25v-4.5a1.748 1.748 0 0 1 .873-1.516.75.75 0 1 1 .752 1.299Z"></path></svg> Version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../timer.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-stopwatch" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M5.75.75A.75.75 0 0 1 6.5 0h3a.75.75 0 0 1 0 1.5h-.75v1l-.001.041a6.724 6.724 0 0 1 3.464 1.435l.007-.006.75-.75a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734l-.75.75-.006.007a6.75 6.75 0 1 1-10.548 0L2.72 5.03l-.75-.75a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l.75.75.007.006A6.72 6.72 0 0 1 7.25 2.541V1.5H6.5a.75.75 0 0 1-.75-.75ZM8 14.5a5.25 5.25 0 1 0-.001-10.501A5.25 5.25 0 0 0 8 14.5Zm.389-6.7 1.33-1.33a.75.75 0 1 1 1.061 1.06L9.45 8.861A1.503 1.503 0 0 1 8 10.75a1.499 1.499 0 1 1 .389-2.95Z"></path></svg> Timer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parameters.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-tasklist" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M2 2h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1Zm4.655 8.595a.75.75 0 0 1 0 1.06L4.03 14.28a.75.75 0 0 1-1.06 0l-1.5-1.5a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l.97.97 2.095-2.095a.75.75 0 0 1 1.06 0ZM9.75 2.5h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5Zm0 5h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5Zm0 5h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5Zm-7.25-9v3h3v-3Z"></path></svg> Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../types.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-file-binary" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2a.75.75 0 0 1-1.5 0Zm-4 6C0 6.784.784 6 1.75 6h1.5C4.216 6 5 6.784 5 7.75v2.5A1.75 1.75 0 0 1 3.25 12h-1.5A1.75 1.75 0 0 1 0 10.25ZM6.75 6h1.5a.75.75 0 0 1 .75.75v3.75h.75a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5h.75v-3h-.75a.75.75 0 0 1 0-1.5Zm-5 1.5a.25.25 0 0 0-.25.25v2.5c0 .138.112.25.25.25h1.5a.25.25 0 0 0 .25-.25v-2.5a.25.25 0 0 0-.25-.25Zm9.75-5.938V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg> Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pygments.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-file-code" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg> Pygments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-book" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path></svg> Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-shield-check" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="m8.533.133 5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667l5.25-1.68a1.748 1.748 0 0 1 1.066 0Zm-.61 1.429.001.001-5.25 1.68a.251.251 0 0 0-.174.237V7c0 1.36.275 2.666 1.057 3.859.784 1.194 2.121 2.342 4.366 3.298a.196.196 0 0 0 .154 0c2.245-.957 3.582-2.103 4.366-3.297C13.225 9.666 13.5 8.358 13.5 7V3.48a.25.25 0 0 0-.174-.238l-5.25-1.68a.25.25 0 0 0-.153 0ZM11.28 6.28l-3.5 3.5a.75.75 0 0 1-1.06 0l-1.5-1.5a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l.97.97 2.97-2.97a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path></svg> CLI testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pytest.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-meter" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8 1.5a6.5 6.5 0 1 0 6.016 4.035.75.75 0 0 1 1.388-.57 8 8 0 1 1-4.37-4.37.75.75 0 1 1-.569 1.389A6.473 6.473 0 0 0 8 1.5Zm6.28.22a.75.75 0 0 1 0 1.06l-4.063 4.064a2.5 2.5 0 1 1-1.06-1.06L13.22 1.72a.75.75 0 0 1 1.06 0ZM7 8a1 1 0 1 0 2 0 1 1 0 0 0-2 0Z"></path></svg> Pytest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../telemetry.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-broadcast" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8.75 8.582v5.668a.75.75 0 0 1-1.5 0V8.582a1.75 1.75 0 1 1 1.5 0Zm3.983-7.125a.75.75 0 0 1 1.06.026A7.976 7.976 0 0 1 16 7c0 2.139-.84 4.083-2.207 5.517a.75.75 0 1 1-1.086-1.034A6.474 6.474 0 0 0 14.5 7a6.474 6.474 0 0 0-1.793-4.483.75.75 0 0 1 .026-1.06Zm-9.466 0c.3.286.312.76.026 1.06A6.474 6.474 0 0 0 1.5 7a6.47 6.47 0 0 0 1.793 4.483.75.75 0 0 1-1.086 1.034A7.973 7.973 0 0 1 0 7c0-2.139.84-4.083 2.207-5.517a.75.75 0 0 1 1.06-.026Zm8.556 2.321A4.988 4.988 0 0 1 13 7a4.988 4.988 0 0 1-1.177 3.222.75.75 0 1 1-1.146-.967A3.487 3.487 0 0 0 11.5 7c0-.86-.309-1.645-.823-2.255a.75.75 0 0 1 1.146-.967Zm-6.492.958A3.48 3.48 0 0 0 4.5 7a3.48 3.48 0 0 0 .823 2.255.75.75 0 0 1-1.146.967A4.981 4.981 0 0 1 3 7a4.982 4.982 0 0 1 1.188-3.236.75.75 0 1 1 1.143.972Z"></path></svg> Telemetry</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../click_extra.html">API</a><input aria-label="Toggle navigation of API" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../click_extra.sphinx.html">click_extra.sphinx package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tests.html">tests package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../py-modindex.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-diff" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8.75 1.75V5H12a.75.75 0 0 1 0 1.5H8.75v3.25a.75.75 0 0 1-1.5 0V6.5H4A.75.75 0 0 1 4 5h3.25V1.75a.75.75 0 0 1 1.5 0ZM4 13h8a.75.75 0 0 1 0 1.5H4A.75.75 0 0 1 4 13Z"></path></svg> Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-bug" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"></path></svg> Fixed issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../todolist.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-checklist" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"></path></svg> Todo-list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code-of-conduct.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-code-of-conduct" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8.048 2.241c.964-.709 2.079-1.238 3.325-1.241a4.616 4.616 0 0 1 3.282 1.355c.41.408.757.86.996 1.428.238.568.348 1.206.347 1.968 0 2.193-1.505 4.254-3.081 5.862-1.496 1.526-3.213 2.796-4.249 3.563l-.22.163a.749.749 0 0 1-.895 0l-.221-.163c-1.036-.767-2.753-2.037-4.249-3.563C1.51 10.008.007 7.952.002 5.762a4.614 4.614 0 0 1 1.353-3.407C3.123.585 6.223.537 8.048 2.24Zm-1.153.983c-1.25-1.033-3.321-.967-4.48.191a3.115 3.115 0 0 0-.913 2.335c0 1.556 1.109 3.24 2.652 4.813C5.463 11.898 6.96 13.032 8 13.805c.353-.262.758-.565 1.191-.905l-1.326-1.223a.75.75 0 0 1 1.018-1.102l1.48 1.366c.328-.281.659-.577.984-.887L9.99 9.802a.75.75 0 1 1 1.019-1.103l1.384 1.28c.295-.329.566-.661.81-.995L12.92 8.7l-1.167-1.168c-.674-.671-1.78-.664-2.474.03-.268.269-.538.537-.802.797-.893.882-2.319.843-3.185-.032-.346-.35-.693-.697-1.043-1.047a.75.75 0 0 1-.04-1.016c.162-.191.336-.401.52-.623.62-.748 1.356-1.637 2.166-2.417Zm7.112 4.442c.313-.65.491-1.293.491-1.916v-.001c0-.614-.088-1.045-.23-1.385-.143-.339-.357-.633-.673-.949a3.111 3.111 0 0 0-2.218-.915c-1.092.003-2.165.627-3.226 1.602-.823.755-1.554 1.637-2.228 2.45l-.127.154.562.566a.755.755 0 0 0 1.066.02l.794-.79c1.258-1.258 3.312-1.31 4.594-.032.396.394.792.791 1.173 1.173Z"></path></svg> Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-law" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8.75.75V2h.985c.304 0 .603.08.867.231l1.29.736c.038.022.08.033.124.033h2.234a.75.75 0 0 1 0 1.5h-.427l2.111 4.692a.75.75 0 0 1-.154.838l-.53-.53.529.531-.001.002-.002.002-.006.006-.006.005-.01.01-.045.04c-.21.176-.441.327-.686.45C14.556 10.78 13.88 11 13 11a4.498 4.498 0 0 1-2.023-.454 3.544 3.544 0 0 1-.686-.45l-.045-.04-.016-.015-.006-.006-.004-.004v-.001a.75.75 0 0 1-.154-.838L12.178 4.5h-.162c-.305 0-.604-.079-.868-.231l-1.29-.736a.245.245 0 0 0-.124-.033H8.75V13h2.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1 0-1.5h2.5V3.5h-.984a.245.245 0 0 0-.124.033l-1.289.737c-.265.15-.564.23-.869.23h-.162l2.112 4.692a.75.75 0 0 1-.154.838l-.53-.53.529.531-.001.002-.002.002-.006.006-.016.015-.045.04c-.21.176-.441.327-.686.45C4.556 10.78 3.88 11 3 11a4.498 4.498 0 0 1-2.023-.454 3.544 3.544 0 0 1-.686-.45l-.045-.04-.016-.015-.006-.006-.004-.004v-.001a.75.75 0 0 1-.154-.838L2.178 4.5H1.75a.75.75 0 0 1 0-1.5h2.234a.249.249 0 0 0 .125-.033l1.288-.737c.265-.15.564-.23.869-.23h.984V.75a.75.75 0 0 1 1.5 0Zm2.945 8.477c.285.135.718.273 1.305.273s1.02-.138 1.305-.273L13 6.327Zm-10 0c.285.135.718.273 1.305.273s1.02-.138 1.305-.273L3 6.327Z"></path></svg> License</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kdeldycke/click-extra">GitHub repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sponsors/kdeldycke">Funding</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for click.core</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cabc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">enum</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">errno</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">t</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractContextManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExitStack</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">update_wrapper</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gettext</span><span class="w"> </span><span class="kn">import</span> <span class="n">gettext</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gettext</span><span class="w"> </span><span class="kn">import</span> <span class="n">ngettext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">repeat</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">types</span><span class="w"> </span><span class="kn">import</span> <span class="n">TracebackType</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">types</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">FLAG_NEEDS_VALUE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">UNSET</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Abort</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">BadParameter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClickException</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Exit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">MissingParameter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoArgsIsHelpError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">UsageError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.formatting</span><span class="w"> </span><span class="kn">import</span> <span class="n">HelpFormatter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.formatting</span><span class="w"> </span><span class="kn">import</span> <span class="n">join_options</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.globals</span><span class="w"> </span><span class="kn">import</span> <span class="n">pop_context</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.globals</span><span class="w"> </span><span class="kn">import</span> <span class="n">push_context</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">_OptionParser</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">_split_opt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.termui</span><span class="w"> </span><span class="kn">import</span> <span class="n">confirm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.termui</span><span class="w"> </span><span class="kn">import</span> <span class="n">prompt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.termui</span><span class="w"> </span><span class="kn">import</span> <span class="n">style</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">_detect_program_name</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">_expand_args</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">echo</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_default_short_help</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_str</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">PacifyFlushWrapper</span>

<span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.shell_completion</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompletionItem</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;t.Callable[..., t.Any]&quot;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_complete_visible_commands</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Command</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all the subcommands of a group that start with the</span>
<span class="sd">    incomplete value and aren&#39;t hidden.</span>

<span class="sd">    :param ctx: Invocation context for the group.</span>
<span class="sd">    :param incomplete: Value being completed. May be empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">multi</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">Group</span><span class="p">,</span> <span class="n">ctx</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">multi</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">incomplete</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">multi</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">command</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_check_nested_chain</span><span class="p">(</span>
    <span class="n">base_command</span><span class="p">:</span> <span class="n">Group</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="n">Command</span><span class="p">,</span> <span class="n">register</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">base_command</span><span class="o">.</span><span class="n">chain</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">Group</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">register</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;It is not possible to add the group </span><span class="si">{</span><span class="n">cmd_name</span><span class="si">!r}</span><span class="s2"> to another&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; group </span><span class="si">{</span><span class="n">base_command</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> that is in chain mode.&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Found the group </span><span class="si">{</span><span class="n">cmd_name</span><span class="si">!r}</span><span class="s2"> as subcommand to another group &quot;</span>
            <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">base_command</span><span class="o">.</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> that is in chain mode. This is not supported.&quot;</span>
        <span class="p">)</span>

    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">batch</span><span class="p">(</span><span class="n">iterable</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">V</span><span class="p">],</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">V</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">repeat</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="nd">@contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">augment_usage_errors</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager that attaches extra information to exceptions.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span>
    <span class="k">except</span> <span class="n">BadParameter</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">ctx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">param</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="n">UsageError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">ctx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span>
        <span class="k">raise</span>


<span class="k">def</span><span class="w"> </span><span class="nf">iter_params_for_processing</span><span class="p">(</span>
    <span class="n">invocation_order</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Parameter</span><span class="p">],</span>
    <span class="n">declaration_order</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Parameter</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all declared parameters in the order they should be processed.</span>

<span class="sd">    The declared parameters are re-shuffled depending on the order in which</span>
<span class="sd">    they were invoked, as well as the eagerness of each parameters.</span>

<span class="sd">    The invocation order takes precedence over the declaration order. I.e. the</span>
<span class="sd">    order in which the user provided them to the CLI is respected.</span>

<span class="sd">    This behavior and its effect on callback evaluation is detailed at:</span>
<span class="sd">    https://click.palletsprojects.com/en/stable/advanced/#callback-evaluation-order</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_key</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">idx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">invocation_order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">is_eager</span><span class="p">,</span> <span class="n">idx</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">declaration_order</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_key</span><span class="p">)</span>


<div class="viewcode-block" id="ParameterSource">
<a class="viewcode-back" href="../../click_extra.html#click_extra.ParameterSource">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ParameterSource</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is an :class:`~enum.Enum` that indicates the source of a</span>
<span class="sd">    parameter&#39;s value.</span>

<span class="sd">    Use :meth:`click.Context.get_parameter_source` to get the</span>
<span class="sd">    source for a parameter by name.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        Use :class:`~enum.Enum` and drop the ``validate`` method.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        Added the ``PROMPT`` value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMMANDLINE</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The value was provided by the command line args.&quot;&quot;&quot;</span>
    <span class="n">ENVIRONMENT</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The value was provided with an environment variable.&quot;&quot;&quot;</span>
    <span class="n">DEFAULT</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used the default specified by the parameter.&quot;&quot;&quot;</span>
    <span class="n">DEFAULT_MAP</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used a default provided by :attr:`Context.default_map`.&quot;&quot;&quot;</span>
    <span class="n">PROMPT</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used a prompt to confirm a default or provide a value.&quot;&quot;&quot;</span></div>



<span class="k">class</span><span class="w"> </span><span class="nc">Context</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The context is a special internal object that holds state relevant</span>
<span class="sd">    for the script execution at every single level.  It&#39;s normally invisible</span>
<span class="sd">    to commands unless they opt-in to getting access to it.</span>

<span class="sd">    The context is useful as it can pass internal objects around and can</span>
<span class="sd">    control special execution features such as reading data from</span>
<span class="sd">    environment variables.</span>

<span class="sd">    A context can be used as context manager in which case it will call</span>
<span class="sd">    :meth:`close` on teardown.</span>

<span class="sd">    :param command: the command class for this context.</span>
<span class="sd">    :param parent: the parent context.</span>
<span class="sd">    :param info_name: the info name for this invocation.  Generally this</span>
<span class="sd">                      is the most descriptive name for the script or</span>
<span class="sd">                      command.  For the toplevel script it is usually</span>
<span class="sd">                      the name of the script, for commands below it it&#39;s</span>
<span class="sd">                      the name of the script.</span>
<span class="sd">    :param obj: an arbitrary object of user data.</span>
<span class="sd">    :param auto_envvar_prefix: the prefix to use for automatic environment</span>
<span class="sd">                               variables.  If this is `None` then reading</span>
<span class="sd">                               from environment variables is disabled.  This</span>
<span class="sd">                               does not affect manually set environment</span>
<span class="sd">                               variables which are always read.</span>
<span class="sd">    :param default_map: a dictionary (like object) with default values</span>
<span class="sd">                        for parameters.</span>
<span class="sd">    :param terminal_width: the width of the terminal.  The default is</span>
<span class="sd">                           inherit from parent context.  If no context</span>
<span class="sd">                           defines the terminal width then auto</span>
<span class="sd">                           detection will be applied.</span>
<span class="sd">    :param max_content_width: the maximum width for content rendered by</span>
<span class="sd">                              Click (this currently only affects help</span>
<span class="sd">                              pages).  This defaults to 80 characters if</span>
<span class="sd">                              not overridden.  In other words: even if the</span>
<span class="sd">                              terminal is larger than that, Click will not</span>
<span class="sd">                              format things wider than 80 characters by</span>
<span class="sd">                              default.  In addition to that, formatters might</span>
<span class="sd">                              add some safety mapping on the right.</span>
<span class="sd">    :param resilient_parsing: if this flag is enabled then Click will</span>
<span class="sd">                              parse without any interactivity or callback</span>
<span class="sd">                              invocation.  Default values will also be</span>
<span class="sd">                              ignored.  This is useful for implementing</span>
<span class="sd">                              things such as completion support.</span>
<span class="sd">    :param allow_extra_args: if this is set to `True` then extra arguments</span>
<span class="sd">                             at the end will not raise an error and will be</span>
<span class="sd">                             kept on the context.  The default is to inherit</span>
<span class="sd">                             from the command.</span>
<span class="sd">    :param allow_interspersed_args: if this is set to `False` then options</span>
<span class="sd">                                    and arguments cannot be mixed.  The</span>
<span class="sd">                                    default is to inherit from the command.</span>
<span class="sd">    :param ignore_unknown_options: instructs click to ignore options it does</span>
<span class="sd">                                   not know and keeps them for later</span>
<span class="sd">                                   processing.</span>
<span class="sd">    :param help_option_names: optionally a list of strings that define how</span>
<span class="sd">                              the default help parameter is named.  The</span>
<span class="sd">                              default is ``[&#39;--help&#39;]``.</span>
<span class="sd">    :param token_normalize_func: an optional function that is used to</span>
<span class="sd">                                 normalize tokens (options, choices,</span>
<span class="sd">                                 etc.).  This for instance can be used to</span>
<span class="sd">                                 implement case insensitive behavior.</span>
<span class="sd">    :param color: controls if the terminal supports ANSI colors or not.  The</span>
<span class="sd">                  default is autodetection.  This is only needed if ANSI</span>
<span class="sd">                  codes are used in texts that Click prints which is by</span>
<span class="sd">                  default not the case.  This for instance would affect</span>
<span class="sd">                  help output.</span>
<span class="sd">    :param show_default: Show the default value for commands. If this</span>
<span class="sd">        value is not set, it defaults to the value from the parent</span>
<span class="sd">        context. ``Command.show_default`` overrides this default for the</span>
<span class="sd">        specific command.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        The ``protected_args`` attribute is deprecated and will be removed in</span>
<span class="sd">        Click 9.0. ``args`` will contain remaining unparsed tokens.</span>

<span class="sd">    .. versionchanged:: 8.1</span>
<span class="sd">        The ``show_default`` parameter is overridden by</span>
<span class="sd">        ``Command.show_default``, instead of the other way around.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        The ``show_default`` parameter defaults to the value from the</span>
<span class="sd">        parent context.</span>

<span class="sd">    .. versionchanged:: 7.1</span>
<span class="sd">       Added the ``show_default`` parameter.</span>

<span class="sd">    .. versionchanged:: 4.0</span>
<span class="sd">        Added the ``color``, ``ignore_unknown_options``, and</span>
<span class="sd">        ``max_content_width`` parameters.</span>

<span class="sd">    .. versionchanged:: 3.0</span>
<span class="sd">        Added the ``allow_extra_args`` and ``allow_interspersed_args``</span>
<span class="sd">        parameters.</span>

<span class="sd">    .. versionchanged:: 2.0</span>
<span class="sd">        Added the ``resilient_parsing``, ``help_option_names``, and</span>
<span class="sd">        ``token_normalize_func`` parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: The formatter class to create with :meth:`make_formatter`.</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. versionadded:: 8.0</span>
    <span class="n">formatter_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">HelpFormatter</span><span class="p">]</span> <span class="o">=</span> <span class="n">HelpFormatter</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">Command</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">info_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">obj</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">auto_envvar_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_map</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">terminal_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_content_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">resilient_parsing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">allow_extra_args</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">allow_interspersed_args</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ignore_unknown_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">help_option_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">token_normalize_func</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#: the parent context or `None` if none exists.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="c1">#: the :class:`Command` for this context.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="c1">#: the descriptive information name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_name</span> <span class="o">=</span> <span class="n">info_name</span>
        <span class="c1">#: Map of parameter names to their parsed values. Parameters</span>
        <span class="c1">#: with ``expose_value=False`` are not stored.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#: the leftover arguments.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#: protected arguments.  These are arguments that are prepended</span>
        <span class="c1">#: to `args` when certain parsing scenarios are encountered but</span>
        <span class="c1">#: must be never propagated to another arguments.  This is used</span>
        <span class="c1">#: to implement nested parsing.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_protected_args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#: the collected prefixes of the command&#39;s options.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_opt_prefixes</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">_opt_prefixes</span><span class="p">)</span> <span class="k">if</span> <span class="n">parent</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">obj</span>

        <span class="c1">#: the user object stored.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1">#: A dictionary (-like object) with defaults for parameters.</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">default_map</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">info_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">parent</span><span class="o">.</span><span class="n">default_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">default_map</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">default_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">info_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_map</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">default_map</span>

        <span class="c1">#: This flag indicates if a subcommand is going to be executed. A</span>
        <span class="c1">#: group callback can use this information to figure out if it&#39;s</span>
        <span class="c1">#: being executed directly or because the execution flow passes</span>
        <span class="c1">#: onwards to a subcommand. By default it&#39;s None, but it can be</span>
        <span class="c1">#: the name of the subcommand to execute.</span>
        <span class="c1">#:</span>
        <span class="c1">#: If chaining is enabled this will be set to ``&#39;*&#39;`` in case</span>
        <span class="c1">#: any commands are executed.  It is however not possible to</span>
        <span class="c1">#: figure out which ones.  If you require this knowledge you</span>
        <span class="c1">#: should use a :func:`result_callback`.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invoked_subcommand</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">terminal_width</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">terminal_width</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">terminal_width</span>

        <span class="c1">#: The width of the terminal (None is autodetection).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">terminal_width</span>

        <span class="k">if</span> <span class="n">max_content_width</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_content_width</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">max_content_width</span>

        <span class="c1">#: The maximum width of formatted content (None implies a sensible</span>
        <span class="c1">#: default which is 80 for most things).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_content_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">max_content_width</span>

        <span class="k">if</span> <span class="n">allow_extra_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">allow_extra_args</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">allow_extra_args</span>

        <span class="c1">#: Indicates if the context allows extra args or if it should</span>
        <span class="c1">#: fail on parsing.</span>
        <span class="c1">#:</span>
        <span class="c1">#: .. versionadded:: 3.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_extra_args</span> <span class="o">=</span> <span class="n">allow_extra_args</span>

        <span class="k">if</span> <span class="n">allow_interspersed_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">allow_interspersed_args</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">allow_interspersed_args</span>

        <span class="c1">#: Indicates if the context allows mixing of arguments and</span>
        <span class="c1">#: options or not.</span>
        <span class="c1">#:</span>
        <span class="c1">#: .. versionadded:: 3.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_interspersed_args</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">allow_interspersed_args</span>

        <span class="k">if</span> <span class="n">ignore_unknown_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ignore_unknown_options</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">ignore_unknown_options</span>

        <span class="c1">#: Instructs click to ignore options that a command does not</span>
        <span class="c1">#: understand and will store it on the context for later</span>
        <span class="c1">#: processing.  This is primarily useful for situations where you</span>
        <span class="c1">#: want to call into external programs.  Generally this pattern is</span>
        <span class="c1">#: strongly discouraged because it&#39;s not possibly to losslessly</span>
        <span class="c1">#: forward all arguments.</span>
        <span class="c1">#:</span>
        <span class="c1">#: .. versionadded:: 4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_unknown_options</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">ignore_unknown_options</span>

        <span class="k">if</span> <span class="n">help_option_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">help_option_names</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">help_option_names</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">help_option_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;--help&quot;</span><span class="p">]</span>

        <span class="c1">#: The names for the help options.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help_option_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">help_option_names</span>

        <span class="k">if</span> <span class="n">token_normalize_func</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">token_normalize_func</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">token_normalize_func</span>

        <span class="c1">#: An optional normalization function for tokens.  This is</span>
        <span class="c1">#: options, choices, commands etc.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token_normalize_func</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">token_normalize_func</span>

        <span class="c1">#: Indicates if resilient parsing is enabled.  In that case Click</span>
        <span class="c1">#: will do its best to not cause any failures and default values</span>
        <span class="c1">#: will be ignored. Useful for completion.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">resilient_parsing</span>

        <span class="c1"># If there is no envvar prefix yet, but the parent has one and</span>
        <span class="c1"># the command on this level has a name, we can expand the envvar</span>
        <span class="c1"># prefix automatically.</span>
        <span class="k">if</span> <span class="n">auto_envvar_prefix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">parent</span><span class="o">.</span><span class="n">auto_envvar_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="n">auto_envvar_prefix</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parent</span><span class="o">.</span><span class="n">auto_envvar_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">info_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">auto_envvar_prefix</span> <span class="o">=</span> <span class="n">auto_envvar_prefix</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">auto_envvar_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">auto_envvar_prefix</span> <span class="o">=</span> <span class="n">auto_envvar_prefix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">auto_envvar_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">auto_envvar_prefix</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">color</span>

        <span class="c1">#: Controls if styling output is wanted or not.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">color</span>

        <span class="k">if</span> <span class="n">show_default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">show_default</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">show_default</span>

        <span class="c1">#: Show option default values when formatting help text.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">show_default</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_close_callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_source</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exit_stack</span> <span class="o">=</span> <span class="n">ExitStack</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">protected_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;&#39;protected_args&#39; is deprecated and will be removed in Click 9.0.&quot;</span>
            <span class="s2">&quot; &#39;args&#39; will contain remaining unparsed tokens.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_protected_args</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_info_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gather information that could be useful for a tool generating</span>
<span class="sd">        user-facing documentation. This traverses the entire CLI</span>
<span class="sd">        structure.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            with Context(cli) as ctx:</span>
<span class="sd">                info = ctx.to_info_dict()</span>

<span class="sd">        .. versionadded:: 8.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">to_info_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s2">&quot;info_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_name</span><span class="p">,</span>
            <span class="s2">&quot;allow_extra_args&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_extra_args</span><span class="p">,</span>
            <span class="s2">&quot;allow_interspersed_args&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_interspersed_args</span><span class="p">,</span>
            <span class="s2">&quot;ignore_unknown_options&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_unknown_options</span><span class="p">,</span>
            <span class="s2">&quot;auto_envvar_prefix&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_envvar_prefix</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Context</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">push_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exc_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tb</span><span class="p">:</span> <span class="n">TracebackType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">exit_result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">exit_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_close_with_exception_info</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>
        <span class="n">pop_context</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">exit_result</span>

    <span class="nd">@contextmanager</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cleanup</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">Context</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This helper method can be used with the context object to promote</span>
<span class="sd">        it to the current thread local (see :func:`get_current_context`).</span>
<span class="sd">        The default behavior of this is to invoke the cleanup functions which</span>
<span class="sd">        can be disabled by setting `cleanup` to `False`.  The cleanup</span>
<span class="sd">        functions are typically used for things such as closing file handles.</span>

<span class="sd">        If the cleanup is intended the context object can also be directly</span>
<span class="sd">        used as a context manager.</span>

<span class="sd">        Example usage::</span>

<span class="sd">            with ctx.scope():</span>
<span class="sd">                assert get_current_context() is ctx</span>

<span class="sd">        This is equivalent::</span>

<span class="sd">            with ctx:</span>
<span class="sd">                assert get_current_context() is ctx</span>

<span class="sd">        .. versionadded:: 5.0</span>

<span class="sd">        :param cleanup: controls if the cleanup functions should be run or</span>
<span class="sd">                        not.  The default is to run these functions.  In</span>
<span class="sd">                        some situations the context only wants to be</span>
<span class="sd">                        temporarily pushed in which case this can be disabled.</span>
<span class="sd">                        Nested pushes automatically defer the cleanup.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cleanup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span> <span class="k">as</span> <span class="n">rv</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">rv</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cleanup</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_depth</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This is a dictionary which is shared with all the contexts</span>
<span class="sd">        that are nested.  It exists so that click utilities can store some</span>
<span class="sd">        state here if they need to.  It is however the responsibility of</span>
<span class="sd">        that code to manage this dictionary well.</span>

<span class="sd">        The keys are supposed to be unique dotted strings.  For instance</span>
<span class="sd">        module paths are a good choice for it.  What is stored in there is</span>
<span class="sd">        irrelevant for the operation of click.  However what is important is</span>
<span class="sd">        that code that places data here adheres to the general semantics of</span>
<span class="sd">        the system.</span>

<span class="sd">        Example usage::</span>

<span class="sd">            LANG_KEY = f&#39;{__name__}.lang&#39;</span>

<span class="sd">            def set_language(value):</span>
<span class="sd">                ctx = get_current_context()</span>
<span class="sd">                ctx.meta[LANG_KEY] = value</span>

<span class="sd">            def get_language():</span>
<span class="sd">                return get_current_context().meta.get(LANG_KEY, &#39;en_US&#39;)</span>

<span class="sd">        .. versionadded:: 5.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meta</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HelpFormatter</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates the :class:`~click.HelpFormatter` for the help and</span>
<span class="sd">        usage output.</span>

<span class="sd">        To quickly customize the formatter class used without overriding</span>
<span class="sd">        this method, set the :attr:`formatter_class` attribute.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Added the :attr:`formatter_class` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter_class</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">terminal_width</span><span class="p">,</span> <span class="n">max_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_content_width</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">with_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context_manager</span><span class="p">:</span> <span class="n">AbstractContextManager</span><span class="p">[</span><span class="n">V</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a resource as if it were used in a ``with``</span>
<span class="sd">        statement. The resource will be cleaned up when the context is</span>
<span class="sd">        popped.</span>

<span class="sd">        Uses :meth:`contextlib.ExitStack.enter_context`. It calls the</span>
<span class="sd">        resource&#39;s ``__enter__()`` method and returns the result. When</span>
<span class="sd">        the context is popped, it closes the stack, which calls the</span>
<span class="sd">        resource&#39;s ``__exit__()`` method.</span>

<span class="sd">        To register a cleanup function for something that isn&#39;t a</span>
<span class="sd">        context manager, use :meth:`call_on_close`. Or use something</span>
<span class="sd">        from :mod:`contextlib` to turn it into a context manager first.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            @click.group()</span>
<span class="sd">            @click.option(&quot;--name&quot;)</span>
<span class="sd">            @click.pass_context</span>
<span class="sd">            def cli(ctx):</span>
<span class="sd">                ctx.obj = ctx.with_resource(connect_db(name))</span>

<span class="sd">        :param context_manager: The context manager to enter.</span>
<span class="sd">        :return: Whatever ``context_manager.__enter__()`` returns.</span>

<span class="sd">        .. versionadded:: 8.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span><span class="n">context_manager</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call_on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a function to be called when the context tears down.</span>

<span class="sd">        This can be used to close resources opened during the script</span>
<span class="sd">        execution. Resources that support Python&#39;s context manager</span>
<span class="sd">        protocol which would be used in a ``with`` statement should be</span>
<span class="sd">        registered with :meth:`with_resource` instead.</span>

<span class="sd">        :param f: The function to execute on teardown.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_stack</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Invoke all close callbacks registered with</span>
<span class="sd">        :meth:`call_on_close`, and exit all context managers entered</span>
<span class="sd">        with :meth:`with_resource`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_with_exception_info</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_close_with_exception_info</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exc_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tb</span><span class="p">:</span> <span class="n">TracebackType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unwind the exit stack by calling its :meth:`__exit__` providing the exception</span>
<span class="sd">        information to allow for exception handling by the various resources registered</span>
<span class="sd">        using :meth;`with_resource`</span>

<span class="sd">        :return: Whatever ``exit_stack.__exit__()`` returns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exit_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exit_stack</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>
        <span class="c1"># In case the context is reused, create a new exit stack.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exit_stack</span> <span class="o">=</span> <span class="n">ExitStack</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">exit_result</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">command_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The computed command path.  This is used for the ``usage``</span>
<span class="sd">        information on the help page.  It&#39;s automatically created by</span>
<span class="sd">        combining the info names of the chain of contexts to the root.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent_command_path</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">command_path</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">Command</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="n">parent_command_path</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get_usage_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

            <span class="n">rv</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_command_path</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">rv</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">rv</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Context</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the outermost context.&quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">return</span> <span class="n">node</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">V</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">V</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the closest object of a given type.&quot;&quot;&quot;</span>
        <span class="n">node</span><span class="p">:</span> <span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">while</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">object_type</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">obj</span>

            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ensure_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">V</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Like :meth:`find_object` but sets the innermost object to a</span>
<span class="sd">        new instance of `object_type` if it does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_object</span><span class="p">(</span><span class="n">object_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">rv</span> <span class="o">=</span> <span class="n">object_type</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">rv</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lookup_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lookup_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">lookup_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the default for a parameter from :attr:`default_map`.</span>

<span class="sd">        :param name: Name of the parameter.</span>
<span class="sd">        :param call: If the default is a callable, call it. Disable to</span>
<span class="sd">            return the callable instead.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Added the ``call`` parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">UNSET</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">call</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">value</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">UNSET</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Aborts the execution of the program with a specific error</span>
<span class="sd">        message.</span>

<span class="sd">        :param message: the error message to fail with.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">UsageError</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">abort</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Aborts the script.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">Abort</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exits the application with a given exit code.</span>

<span class="sd">        .. versionchanged:: 8.2</span>
<span class="sd">            Callbacks and context managers registered with :meth:`call_on_close`</span>
<span class="sd">            and :meth:`with_resource` are closed before exiting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">raise</span> <span class="n">Exit</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method to get formatted usage string for the current</span>
<span class="sd">        context and command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">get_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_help</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method to get formatted help page for the current</span>
<span class="sd">        context and command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">get_help</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_sub_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">Command</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Context</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new context of the same type as this context, but</span>
<span class="sd">        for a new command.</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">command</span><span class="p">,</span> <span class="n">info_name</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">V</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">V</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Command</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Command</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">V</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n">V</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Invokes a command callback in exactly the way it expects.  There</span>
<span class="sd">        are two ways to invoke this method:</span>

<span class="sd">        1.  the first argument can be a callback and all other arguments and</span>
<span class="sd">            keyword arguments are forwarded directly to the function.</span>
<span class="sd">        2.  the first argument is a click command object.  In that case all</span>
<span class="sd">            arguments are forwarded as well but proper click parameters</span>
<span class="sd">            (options and click arguments) must be keyword arguments and Click</span>
<span class="sd">            will fill in defaults.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            All ``kwargs`` are tracked in :attr:`params` so they will be</span>
<span class="sd">            passed if :meth:`forward` is called at multiple levels.</span>

<span class="sd">        .. versionchanged:: 3.2</span>
<span class="sd">            A new context is created, and missing arguments use default values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">Command</span><span class="p">):</span>
            <span class="n">other_cmd</span> <span class="o">=</span> <span class="n">callback</span>

            <span class="k">if</span> <span class="n">other_cmd</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;The given command does not have a callback that can be invoked.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">callback</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;t.Callable[..., V]&quot;</span><span class="p">,</span> <span class="n">other_cmd</span><span class="o">.</span><span class="n">callback</span><span class="p">)</span>

            <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_sub_context</span><span class="p">(</span><span class="n">other_cmd</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">other_cmd</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">expose_value</span><span class="p">:</span>
                    <span class="n">default_value</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">get_default</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                    <span class="c1"># We explicitly hide the :attr:`UNSET` value to the user, as we</span>
                    <span class="c1"># choose to make it an implementation detail. And because ``invoke``</span>
                    <span class="c1"># has been designed as part of Click public API, we return ``None``</span>
                    <span class="c1"># instead. Refs:</span>
                    <span class="c1"># https://github.com/pallets/click/issues/3066</span>
                    <span class="c1"># https://github.com/pallets/click/issues/3065</span>
                    <span class="c1"># https://github.com/pallets/click/pull/3068</span>
                    <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
                        <span class="n">default_value</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">type_cast_value</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
                        <span class="n">ctx</span><span class="p">,</span> <span class="n">default_value</span>
                    <span class="p">)</span>

            <span class="c1"># Track all kwargs as params, so that forward() will pass</span>
            <span class="c1"># them on in subsequent calls.</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">with</span> <span class="n">augment_usage_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">ctx</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="n">Command</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Similar to :meth:`invoke` but fills in default keyword</span>
<span class="sd">        arguments from the current context if the other command expects</span>
<span class="sd">        it.  This cannot invoke callbacks directly, only other commands.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            All ``kwargs`` are tracked in :attr:`params` so they will be</span>
<span class="sd">            passed if ``forward`` is called at multiple levels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Can only forward to other commands, not direct callbacks.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">Command</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Callback is not a command.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_parameter_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">ParameterSource</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the source of a parameter. This indicates the location</span>
<span class="sd">        from which the value of the parameter was obtained.</span>

<span class="sd">        :param name: The name of the parameter.</span>
<span class="sd">        :param source: A member of :class:`~click.core.ParameterSource`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_source</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_parameter_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParameterSource</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the source of a parameter. This indicates the location</span>
<span class="sd">        from which the value of the parameter was obtained.</span>

<span class="sd">        This can be useful for determining when a user specified a value</span>
<span class="sd">        on the command line that is the same as the default value. It</span>
<span class="sd">        will be :attr:`~click.core.ParameterSource.DEFAULT` only if the</span>
<span class="sd">        value was actually taken from the default.</span>

<span class="sd">        :param name: The name of the parameter.</span>
<span class="sd">        :rtype: ParameterSource</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Returns ``None`` if the parameter was not provided from any</span>
<span class="sd">            source.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Command</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Commands are the basic building block of command line interfaces in</span>
<span class="sd">    Click.  A basic command handles command line parsing and might dispatch</span>
<span class="sd">    more parsing to commands nested below it.</span>

<span class="sd">    :param name: the name of the command to use unless a group overrides it.</span>
<span class="sd">    :param context_settings: an optional dictionary with defaults that are</span>
<span class="sd">                             passed to the context object.</span>
<span class="sd">    :param callback: the callback to invoke.  This is optional.</span>
<span class="sd">    :param params: the parameters to register with this command.  This can</span>
<span class="sd">                   be either :class:`Option` or :class:`Argument` objects.</span>
<span class="sd">    :param help: the help string to use for this command.</span>
<span class="sd">    :param epilog: like the help string but it&#39;s printed at the end of the</span>
<span class="sd">                   help page after everything else.</span>
<span class="sd">    :param short_help: the short help to use for this command.  This is</span>
<span class="sd">                       shown on the command listing of the parent command.</span>
<span class="sd">    :param add_help_option: by default each command registers a ``--help``</span>
<span class="sd">                            option.  This can be disabled by this parameter.</span>
<span class="sd">    :param no_args_is_help: this controls what happens if no arguments are</span>
<span class="sd">                            provided.  This option is disabled by default.</span>
<span class="sd">                            If enabled this will add ``--help`` as argument</span>
<span class="sd">                            if no arguments are passed</span>
<span class="sd">    :param hidden: hide this command from help outputs.</span>
<span class="sd">    :param deprecated: If ``True`` or non-empty string, issues a message</span>
<span class="sd">                        indicating that the command is deprecated and highlights</span>
<span class="sd">                        its deprecation in --help. The message can be customized</span>
<span class="sd">                        by using a string as the value.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        This is the base class for all commands, not ``BaseCommand``.</span>
<span class="sd">        ``deprecated`` can be set to a string as well to customize the</span>
<span class="sd">        deprecation message.</span>

<span class="sd">    .. versionchanged:: 8.1</span>
<span class="sd">        ``help``, ``epilog``, and ``short_help`` are stored unprocessed,</span>
<span class="sd">        all formatting is done when outputting help text, not at init,</span>
<span class="sd">        and is done even if not using the ``@command`` decorator.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        Added a ``repr`` showing the command name.</span>

<span class="sd">    .. versionchanged:: 7.1</span>
<span class="sd">        Added the ``no_args_is_help`` parameter.</span>

<span class="sd">    .. versionchanged:: 2.0</span>
<span class="sd">        Added the ``context_settings`` parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: The context class to create with :meth:`make_context`.</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. versionadded:: 8.0</span>
    <span class="n">context_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Context</span><span class="p">]</span> <span class="o">=</span> <span class="n">Context</span>

    <span class="c1">#: the default for the :attr:`Context.allow_extra_args` flag.</span>
    <span class="n">allow_extra_args</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: the default for the :attr:`Context.allow_interspersed_args` flag.</span>
    <span class="n">allow_interspersed_args</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">#: the default for the :attr:`Context.ignore_unknown_options` flag.</span>
    <span class="n">ignore_unknown_options</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">context_settings</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">help</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">epilog</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">short_help</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">options_metavar</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;[OPTIONS]&quot;</span><span class="p">,</span>
        <span class="n">add_help_option</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">no_args_is_help</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">deprecated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#: the name the command thinks it has.  Upon registering a command</span>
        <span class="c1">#: on a :class:`Group` the group will default the command name</span>
        <span class="c1">#: with this information.  You should instead use the</span>
        <span class="c1">#: :class:`Context`\&#39;s :attr:`~Context.info_name` attribute.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">if</span> <span class="n">context_settings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context_settings</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1">#: an optional dictionary with defaults passed to the context.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_settings</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_settings</span>

        <span class="c1">#: the callback to execute when the command fires.  This might be</span>
        <span class="c1">#: `None` in which case nothing happens.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="c1">#: the list of parameters for this command in the order they</span>
        <span class="c1">#: should show up in the help page and execute.  Eager parameters</span>
        <span class="c1">#: will automatically be handled before non eager ones.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="n">help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epilog</span> <span class="o">=</span> <span class="n">epilog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options_metavar</span> <span class="o">=</span> <span class="n">options_metavar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">short_help</span> <span class="o">=</span> <span class="n">short_help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_help_option</span> <span class="o">=</span> <span class="n">add_help_option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_help_option</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">no_args_is_help</span> <span class="o">=</span> <span class="n">no_args_is_help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">hidden</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span> <span class="o">=</span> <span class="n">deprecated</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_info_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">to_info_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">)],</span>
            <span class="s2">&quot;help&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">,</span>
            <span class="s2">&quot;epilog&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">epilog</span><span class="p">,</span>
            <span class="s2">&quot;short_help&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">short_help</span><span class="p">,</span>
            <span class="s2">&quot;hidden&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">,</span>
            <span class="s2">&quot;deprecated&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Formats the usage line into a string and returns it.</span>

<span class="sd">        Calls :meth:`format_usage` internally.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">make_formatter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_usage</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Parameter</span><span class="p">]:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
        <span class="n">help_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_help_option</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">help_option</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">params</span><span class="p">,</span> <span class="n">help_option</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

            <span class="n">opts</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">]</span>
            <span class="n">opts_counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>
            <span class="n">duplicate_opts</span> <span class="o">=</span> <span class="p">(</span><span class="n">opt</span> <span class="k">for</span> <span class="n">opt</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">opts_counter</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">duplicate_opt</span> <span class="ow">in</span> <span class="n">duplicate_opts</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;The parameter </span><span class="si">{</span><span class="n">duplicate_opt</span><span class="si">}</span><span class="s2"> is used more than once. &quot;</span>
                        <span class="s2">&quot;Remove its duplicate as parameters should be unique.&quot;</span>
                    <span class="p">),</span>
                    <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes the usage line into the formatter.</span>

<span class="sd">        This is a low-level method called by :meth:`get_usage`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect_usage_pieces</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">formatter</span><span class="o">.</span><span class="n">write_usage</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">command_path</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pieces</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_usage_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the pieces that go into the usage line and returns</span>
<span class="sd">        it as a list of strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">options_metavar</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options_metavar</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">rv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get_usage_pieces</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_help_option_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the names for the help option.&quot;&quot;&quot;</span>
        <span class="n">all_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">help_option_names</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
            <span class="n">all_names</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">)</span>
            <span class="n">all_names</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_names</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_help_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Option</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the help option object.</span>

<span class="sd">        Skipped if :attr:`add_help_option` is ``False``.</span>

<span class="sd">        .. versionchanged:: 8.1.8</span>
<span class="sd">            The help option is now cached to avoid creating it multiple times.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">help_option_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_help_option_names</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">help_option_names</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_help_option</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Cache the help option object in private _help_option attribute to</span>
        <span class="c1"># avoid creating it multiple times. Not doing this will break the</span>
        <span class="c1"># callback odering by iter_params_for_processing(), which relies on</span>
        <span class="c1"># object comparison.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_help_option</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Avoid circular import.</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">help_option</span>

            <span class="c1"># Apply help_option decorator and pop resulting option</span>
            <span class="n">help_option</span><span class="p">(</span><span class="o">*</span><span class="n">help_option_names</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_help_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>  <span class="c1"># type: ignore[assignment]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_help_option</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_OptionParser</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates the underlying option parser for this command.&quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">_OptionParser</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">param</span><span class="o">.</span><span class="n">add_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parser</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Formats the help into a string and returns it.</span>

<span class="sd">        Calls :meth:`format_help` internally.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">make_formatter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_help</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_short_help_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">45</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets short help for the command or makes it by shortening the</span>
<span class="sd">        long help string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">short_help</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">short_help</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">make_default_short_help</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">:</span>
            <span class="n">deprecated_message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;(DEPRECATED: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;(DEPRECATED)&quot;</span>
            <span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{text}</span><span class="s2"> </span><span class="si">{deprecated_message}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">deprecated_message</span><span class="o">=</span><span class="n">deprecated_message</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes the help into the formatter if it exists.</span>

<span class="sd">        This is a low-level method called by :meth:`get_help`.</span>

<span class="sd">        This calls the following methods:</span>

<span class="sd">        -   :meth:`format_usage`</span>
<span class="sd">        -   :meth:`format_help_text`</span>
<span class="sd">        -   :meth:`format_options`</span>
<span class="sd">        -   :meth:`format_epilog`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_usage</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_help_text</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_options</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_epilog</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_help_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes the help text to the formatter if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># truncate the help text to the first form feed</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">)</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\f</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">:</span>
            <span class="n">deprecated_message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;(DEPRECATED: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;(DEPRECATED)&quot;</span>
            <span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{text}</span><span class="s2"> </span><span class="si">{deprecated_message}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">deprecated_message</span><span class="o">=</span><span class="n">deprecated_message</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">formatter</span><span class="o">.</span><span class="n">write_paragraph</span><span class="p">()</span>

            <span class="k">with</span> <span class="n">formatter</span><span class="o">.</span><span class="n">indentation</span><span class="p">():</span>
                <span class="n">formatter</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes all the options into the formatter if they exist.&quot;&quot;&quot;</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">get_help_record</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">opts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">formatter</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Options&quot;</span><span class="p">)):</span>
                <span class="n">formatter</span><span class="o">.</span><span class="n">write_dl</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_epilog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes the epilog into the formatter if it exists.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epilog</span><span class="p">:</span>
            <span class="n">epilog</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epilog</span><span class="p">)</span>
            <span class="n">formatter</span><span class="o">.</span><span class="n">write_paragraph</span><span class="p">()</span>

            <span class="k">with</span> <span class="n">formatter</span><span class="o">.</span><span class="n">indentation</span><span class="p">():</span>
                <span class="n">formatter</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">epilog</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_context</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">info_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">extra</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Context</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function when given an info name and arguments will kick</span>
<span class="sd">        off the parsing and create a new :class:`Context`.  It does not</span>
<span class="sd">        invoke the actual command callback though.</span>

<span class="sd">        To quickly customize the context class used without overriding</span>
<span class="sd">        this method, set the :attr:`context_class` attribute.</span>

<span class="sd">        :param info_name: the info name for this invocation.  Generally this</span>
<span class="sd">                          is the most descriptive name for the script or</span>
<span class="sd">                          command.  For the toplevel script it&#39;s usually</span>
<span class="sd">                          the name of the script, for commands below it&#39;s</span>
<span class="sd">                          the name of the command.</span>
<span class="sd">        :param args: the arguments to parse as list of strings.</span>
<span class="sd">        :param parent: the parent context if available.</span>
<span class="sd">        :param extra: extra keyword arguments forwarded to the context</span>
<span class="sd">                      constructor.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Added the :attr:`context_class` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">extra</span><span class="p">:</span>
                <span class="n">extra</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info_name</span><span class="o">=</span><span class="n">info_name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">ctx</span><span class="o">.</span><span class="n">scope</span><span class="p">(</span><span class="n">cleanup</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ctx</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_args_is_help</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoArgsIsHelpError</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="n">parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_parser</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">opts</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">param_order</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">iter_params_for_processing</span><span class="p">(</span><span class="n">param_order</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">)):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">handle_parse_result</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="c1"># We now have all parameters&#39; values into `ctx.params`, but the data may contain</span>
        <span class="c1"># the `UNSET` sentinel.</span>
        <span class="c1"># Convert `UNSET` to `None` to ensure that the user doesn&#39;t see `UNSET`.</span>
        <span class="c1">#</span>
        <span class="c1"># Waiting until after the initial parse to convert allows us to treat `UNSET`</span>
        <span class="c1"># more like a missing value when multiple params use the same name.</span>
        <span class="c1"># Refs:</span>
        <span class="c1"># https://github.com/pallets/click/issues/3071</span>
        <span class="c1"># https://github.com/pallets/click/pull/3079</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">allow_extra_args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span>
                <span class="n">ngettext</span><span class="p">(</span>
                    <span class="s2">&quot;Got unexpected extra argument (</span><span class="si">{args}</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Got unexpected extra arguments (</span><span class="si">{args}</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span>
                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">args</span><span class="p">)))</span>
            <span class="p">)</span>

        <span class="n">ctx</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">_opt_prefixes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">_opt_prefixes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a context, this invokes the attached callback (if it exists)</span>
<span class="sd">        in the right way.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">:</span>
            <span class="n">extra_message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span>
                <span class="s2">&quot;DeprecationWarning: The command </span><span class="si">{name!r}</span><span class="s2"> is deprecated.</span><span class="si">{extra_message}</span><span class="s2">&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">extra_message</span><span class="o">=</span><span class="n">extra_message</span><span class="p">)</span>
            <span class="n">echo</span><span class="p">(</span><span class="n">style</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span> <span class="n">err</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">,</span> <span class="o">**</span><span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">shell_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">CompletionItem</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of completions for the incomplete value. Looks</span>
<span class="sd">        at the names of options and chained multi-commands.</span>

<span class="sd">        Any command could be part of a chained multi-command, so sibling</span>
<span class="sd">        commands are valid at any point during command completion.</span>

<span class="sd">        :param ctx: Invocation context for this command.</span>
<span class="sd">        :param incomplete: Value being completed. May be empty.</span>

<span class="sd">        .. versionadded:: 8.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">click.shell_completion</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompletionItem</span>

        <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CompletionItem</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">incomplete</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">incomplete</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">Option</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="n">param</span><span class="o">.</span><span class="n">hidden</span>
                    <span class="ow">or</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">multiple</span>
                        <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_parameter_source</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                        <span class="ow">is</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">COMMANDLINE</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">continue</span>

                <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="n">CompletionItem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">param</span><span class="o">.</span><span class="n">help</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">param</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span> <span class="o">*</span><span class="n">param</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">incomplete</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">while</span> <span class="n">ctx</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">parent</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">command</span><span class="p">,</span> <span class="n">Group</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">chain</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="n">CompletionItem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">get_short_help_str</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">_complete_visible_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">_protected_args</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prog_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">complete_var</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">standalone_mode</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">extra</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prog_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">complete_var</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">standalone_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="o">**</span><span class="n">extra</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prog_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">complete_var</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">standalone_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">windows_expand_args</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">extra</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This is the way to invoke a script with all the bells and</span>
<span class="sd">        whistles as a command line application.  This will always terminate</span>
<span class="sd">        the application after a call.  If this is not wanted, ``SystemExit``</span>
<span class="sd">        needs to be caught.</span>

<span class="sd">        This method is also available by directly calling the instance of</span>
<span class="sd">        a :class:`Command`.</span>

<span class="sd">        :param args: the arguments that should be used for parsing.  If not</span>
<span class="sd">                     provided, ``sys.argv[1:]`` is used.</span>
<span class="sd">        :param prog_name: the program name that should be used.  By default</span>
<span class="sd">                          the program name is constructed by taking the file</span>
<span class="sd">                          name from ``sys.argv[0]``.</span>
<span class="sd">        :param complete_var: the environment variable that controls the</span>
<span class="sd">                             bash completion support.  The default is</span>
<span class="sd">                             ``&quot;_&lt;prog_name&gt;_COMPLETE&quot;`` with prog_name in</span>
<span class="sd">                             uppercase.</span>
<span class="sd">        :param standalone_mode: the default behavior is to invoke the script</span>
<span class="sd">                                in standalone mode.  Click will then</span>
<span class="sd">                                handle exceptions and convert them into</span>
<span class="sd">                                error messages and the function will never</span>
<span class="sd">                                return but shut down the interpreter.  If</span>
<span class="sd">                                this is set to `False` they will be</span>
<span class="sd">                                propagated to the caller and the return</span>
<span class="sd">                                value of this function is the return value</span>
<span class="sd">                                of :meth:`invoke`.</span>
<span class="sd">        :param windows_expand_args: Expand glob patterns, user dir, and</span>
<span class="sd">            env vars in command line args on Windows.</span>
<span class="sd">        :param extra: extra keyword arguments are forwarded to the context</span>
<span class="sd">                      constructor.  See :class:`Context` for more information.</span>

<span class="sd">        .. versionchanged:: 8.0.1</span>
<span class="sd">            Added the ``windows_expand_args`` parameter to allow</span>
<span class="sd">            disabling command line arg expansion on Windows.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            When taking arguments from ``sys.argv`` on Windows, glob</span>
<span class="sd">            patterns, user dir, and env vars are expanded.</span>

<span class="sd">        .. versionchanged:: 3.0</span>
<span class="sd">           Added the ``standalone_mode`` parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span> <span class="ow">and</span> <span class="n">windows_expand_args</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">_expand_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">prog_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prog_name</span> <span class="o">=</span> <span class="n">_detect_program_name</span><span class="p">()</span>

        <span class="c1"># Process shell completion requests and exit early.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_main_shell_completion</span><span class="p">(</span><span class="n">extra</span><span class="p">,</span> <span class="n">prog_name</span><span class="p">,</span> <span class="n">complete_var</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_context</span><span class="p">(</span><span class="n">prog_name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">extra</span><span class="p">)</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
                    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">standalone_mode</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">rv</span>
                    <span class="c1"># it&#39;s not safe to `ctx.exit(rv)` here!</span>
                    <span class="c1"># note that `rv` may actually contain data like &quot;1&quot; which</span>
                    <span class="c1"># has obvious effects</span>
                    <span class="c1"># more subtle case: `rv=[None, None]` can come out of</span>
                    <span class="c1"># chained commands which all returned `None` -- so it&#39;s not</span>
                    <span class="c1"># even always obvious that `rv` indicates success/failure</span>
                    <span class="c1"># by its truthiness/falsiness</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">echo</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">Abort</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="k">except</span> <span class="n">ClickException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">standalone_mode</span><span class="p">:</span>
                    <span class="k">raise</span>
                <span class="n">e</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EPIPE</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">PacifyFlushWrapper</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">PacifyFlushWrapper</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">))</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="k">except</span> <span class="n">Exit</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">standalone_mode</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># in non-standalone mode, return the exit code</span>
                <span class="c1"># note that this is only reached if `self.invoke` above raises</span>
                <span class="c1"># an Exit explicitly -- thus bypassing the check there which</span>
                <span class="c1"># would return its result</span>
                <span class="c1"># the results of non-standalone execution may therefore be</span>
                <span class="c1"># somewhat ambiguous: if there are codepaths which lead to</span>
                <span class="c1"># `ctx.exit(1)` and to `return 1`, the caller won&#39;t be able to</span>
                <span class="c1"># tell the difference between the two</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">exit_code</span>
        <span class="k">except</span> <span class="n">Abort</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">standalone_mode</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="n">echo</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Aborted!&quot;</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_main_shell_completion</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ctx_args</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
        <span class="n">prog_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">complete_var</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the shell is asking for tab completion, process</span>
<span class="sd">        that, then exit early. Called from :meth:`main` before the</span>
<span class="sd">        program is invoked.</span>

<span class="sd">        :param prog_name: Name of the executable in the shell.</span>
<span class="sd">        :param complete_var: Name of the environment variable that holds</span>
<span class="sd">            the completion instruction. Defaults to</span>
<span class="sd">            ``_{PROG_NAME}_COMPLETE``.</span>

<span class="sd">        .. versionchanged:: 8.2.0</span>
<span class="sd">            Dots (``.``) in ``prog_name`` are replaced with underscores (``_``).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">complete_var</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">complete_name</span> <span class="o">=</span> <span class="n">prog_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">complete_var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">complete_name</span><span class="si">}</span><span class="s2">_COMPLETE&quot;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="n">instruction</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">complete_var</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">instruction</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">.shell_completion</span><span class="w"> </span><span class="kn">import</span> <span class="n">shell_complete</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="n">shell_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx_args</span><span class="p">,</span> <span class="n">prog_name</span><span class="p">,</span> <span class="n">complete_var</span><span class="p">,</span> <span class="n">instruction</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for :meth:`main`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_FakeSubclassCheck</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__subclasscheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">subclass</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__instancecheck__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_BaseCommand</span><span class="p">(</span><span class="n">Command</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_FakeSubclassCheck</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated:: 8.2</span>
<span class="sd">        Will be removed in Click 9.0. Use ``Command`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Group</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A group is a command that nests other commands (or more groups).</span>

<span class="sd">    :param name: The name of the group command.</span>
<span class="sd">    :param commands: Map names to :class:`Command` objects. Can be a list, which</span>
<span class="sd">        will use :attr:`Command.name` as the keys.</span>
<span class="sd">    :param invoke_without_command: Invoke the group&#39;s callback even if a</span>
<span class="sd">        subcommand is not given.</span>
<span class="sd">    :param no_args_is_help: If no arguments are given, show the group&#39;s help and</span>
<span class="sd">        exit. Defaults to the opposite of ``invoke_without_command``.</span>
<span class="sd">    :param subcommand_metavar: How to represent the subcommand argument in help.</span>
<span class="sd">        The default will represent whether ``chain`` is set or not.</span>
<span class="sd">    :param chain: Allow passing more than one subcommand argument. After parsing</span>
<span class="sd">        a command&#39;s arguments, if any arguments remain another command will be</span>
<span class="sd">        matched, and so on.</span>
<span class="sd">    :param result_callback: A function to call after the group&#39;s and</span>
<span class="sd">        subcommand&#39;s callbacks. The value returned by the subcommand is passed.</span>
<span class="sd">        If ``chain`` is enabled, the value will be a list of values returned by</span>
<span class="sd">        all the commands. If ``invoke_without_command`` is enabled, the value</span>
<span class="sd">        will be the value returned by the group&#39;s callback, or an empty list if</span>
<span class="sd">        ``chain`` is enabled.</span>
<span class="sd">    :param kwargs: Other arguments passed to :class:`Command`.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        The ``commands`` argument can be a list of command objects.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        Merged with and replaces the ``MultiCommand`` base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">allow_extra_args</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">allow_interspersed_args</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: If set, this is used by the group&#39;s :meth:`command` decorator</span>
    <span class="c1">#: as the default :class:`Command` class. This is useful to make all</span>
    <span class="c1">#: subcommands use a custom command class.</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. versionadded:: 8.0</span>
    <span class="n">command_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Command</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#: If set, this is used by the group&#39;s :meth:`group` decorator</span>
    <span class="c1">#: as the default :class:`Group` class. This is useful to make all</span>
    <span class="c1">#: subgroups use a custom group class.</span>
    <span class="c1">#:</span>
    <span class="c1">#: If set to the special value :class:`type` (literally</span>
    <span class="c1">#: ``group_class = type``), this group&#39;s class will be used as the</span>
    <span class="c1">#: default class. This makes a custom group class continue to make</span>
    <span class="c1">#: custom groups.</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. versionadded:: 8.0</span>
    <span class="n">group_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Group</span><span class="p">]</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Literal[type] isn&#39;t valid, so use Type[type]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">commands</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Command</span><span class="p">]</span>
        <span class="o">|</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Command</span><span class="p">]</span>
        <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">invoke_without_command</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">no_args_is_help</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">subcommand_metavar</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">chain</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">result_callback</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">commands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">commands</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

        <span class="c1">#: The registered subcommands by their exported names.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Command</span><span class="p">]</span> <span class="o">=</span> <span class="n">commands</span>

        <span class="k">if</span> <span class="n">no_args_is_help</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">no_args_is_help</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">invoke_without_command</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">no_args_is_help</span> <span class="o">=</span> <span class="n">no_args_is_help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invoke_without_command</span> <span class="o">=</span> <span class="n">invoke_without_command</span>

        <span class="k">if</span> <span class="n">subcommand_metavar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chain</span><span class="p">:</span>
                <span class="n">subcommand_metavar</span> <span class="o">=</span> <span class="s2">&quot;COMMAND1 [ARGS]... [COMMAND2 [ARGS]...]...&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subcommand_metavar</span> <span class="o">=</span> <span class="s2">&quot;COMMAND [ARGS]...&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subcommand_metavar</span> <span class="o">=</span> <span class="n">subcommand_metavar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chain</span> <span class="o">=</span> <span class="n">chain</span>
        <span class="c1"># The result callback that is stored. This can be set or</span>
        <span class="c1"># overridden with the :func:`result_callback` decorator.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result_callback</span> <span class="o">=</span> <span class="n">result_callback</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">Argument</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="s2">&quot;A group in chain mode cannot have optional arguments.&quot;</span>
                    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_info_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="n">info_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">to_info_dict</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">sub_ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">_make_sub_context</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">sub_ctx</span><span class="o">.</span><span class="n">scope</span><span class="p">(</span><span class="n">cleanup</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span><span class="o">.</span><span class="n">to_info_dict</span><span class="p">(</span><span class="n">sub_ctx</span><span class="p">)</span>

        <span class="n">info_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">commands</span><span class="o">=</span><span class="n">commands</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">info_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="n">Command</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registers another :class:`Command` with this group.  If the name</span>
<span class="sd">        is not provided, the name of the command is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">cmd</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Command has no name.&quot;</span><span class="p">)</span>
        <span class="n">_check_nested_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">register</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmd</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__func</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Command</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span> <span class="n">Command</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span> <span class="n">Command</span><span class="p">]</span> <span class="o">|</span> <span class="n">Command</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A shortcut decorator for declaring and attaching a command to</span>
<span class="sd">        the group. This takes the same arguments as :func:`command` and</span>
<span class="sd">        immediately registers the created command with this group by</span>
<span class="sd">        calling :meth:`add_command`.</span>

<span class="sd">        To customize the command class used, set the</span>
<span class="sd">        :attr:`command_class` attribute.</span>

<span class="sd">        .. versionchanged:: 8.1</span>
<span class="sd">            This decorator can be applied without parentheses.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Added the :attr:`command_class` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">command</span>

        <span class="n">func</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">(</span>
                <span class="s2">&quot;Use &#39;command(**kwargs)(callable)&#39; to provide arguments.&quot;</span>
            <span class="p">)</span>
            <span class="p">(</span><span class="n">func</span><span class="p">,)</span> <span class="o">=</span> <span class="n">args</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_class</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cls&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_class</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Command</span><span class="p">:</span>
            <span class="n">cmd</span><span class="p">:</span> <span class="n">Command</span> <span class="o">=</span> <span class="n">command</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cmd</span>

        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__func</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Group</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">group</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span> <span class="n">Group</span><span class="p">]:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">group</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span> <span class="n">Group</span><span class="p">]</span> <span class="o">|</span> <span class="n">Group</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A shortcut decorator for declaring and attaching a group to</span>
<span class="sd">        the group. This takes the same arguments as :func:`group` and</span>
<span class="sd">        immediately registers the created group with this group by</span>
<span class="sd">        calling :meth:`add_command`.</span>

<span class="sd">        To customize the group class used, set the :attr:`group_class`</span>
<span class="sd">        attribute.</span>

<span class="sd">        .. versionchanged:: 8.1</span>
<span class="sd">            This decorator can be applied without parentheses.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Added the :attr:`group_class` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">group</span>

        <span class="n">func</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">args</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">,</span> <span class="p">(</span>
                <span class="s2">&quot;Use &#39;group(**kwargs)(callable)&#39; to provide arguments.&quot;</span>
            <span class="p">)</span>
            <span class="p">(</span><span class="n">func</span><span class="p">,)</span> <span class="o">=</span> <span class="n">args</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cls&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_class</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_class</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Group</span><span class="p">:</span>
            <span class="n">cmd</span><span class="p">:</span> <span class="n">Group</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cmd</span>

        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">result_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">F</span><span class="p">],</span> <span class="n">F</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a result callback to the command.  By default if a</span>
<span class="sd">        result callback is already registered this will chain them but</span>
<span class="sd">        this can be disabled with the `replace` parameter.  The result</span>
<span class="sd">        callback is invoked with the return value of the subcommand</span>
<span class="sd">        (or the list of return values from all subcommands if chaining</span>
<span class="sd">        is enabled) as well as the parameters as they would be passed</span>
<span class="sd">        to the main callback.</span>

<span class="sd">        Example::</span>

<span class="sd">            @click.group()</span>
<span class="sd">            @click.option(&#39;-i&#39;, &#39;--input&#39;, default=23)</span>
<span class="sd">            def cli(input):</span>
<span class="sd">                return 42</span>

<span class="sd">            @cli.result_callback()</span>
<span class="sd">            def process_result(result, input):</span>
<span class="sd">                return result + input</span>

<span class="sd">        :param replace: if set to `True` an already existing result</span>
<span class="sd">                        callback will be removed.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Renamed from ``resultcallback``.</span>

<span class="sd">        .. versionadded:: 3.0</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">F</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">F</span><span class="p">:</span>
            <span class="n">old_callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result_callback</span>

            <span class="k">if</span> <span class="n">old_callback</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">replace</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_result_callback</span> <span class="o">=</span> <span class="n">f</span>
                <span class="k">return</span> <span class="n">f</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
                <span class="n">inner</span> <span class="o">=</span> <span class="n">old_callback</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">inner</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_result_callback</span> <span class="o">=</span> <span class="n">rv</span> <span class="o">=</span> <span class="n">update_wrapper</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">function</span><span class="p">),</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rv</span>  <span class="c1"># type: ignore[return-value]</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Command</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a context and a command name, this returns a :class:`Command`</span>
<span class="sd">        object if it exists or returns ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cmd_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of subcommand names in the order they should appear.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">collect_usage_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">collect_usage_pieces</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">rv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subcommand_metavar</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_options</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">formatter</span><span class="p">:</span> <span class="n">HelpFormatter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extra format methods for multi methods that adds all the commands</span>
<span class="sd">        after the options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subcommand</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">subcommand</span><span class="p">)</span>
            <span class="c1"># What is this, the tool lied about a command.  Ignore it</span>
            <span class="k">if</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">commands</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">subcommand</span><span class="p">,</span> <span class="n">cmd</span><span class="p">))</span>

        <span class="c1"># allow for 3 times the default spacing</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">commands</span><span class="p">):</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">)</span>

            <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">subcommand</span><span class="p">,</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
                <span class="n">help</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_short_help_str</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">subcommand</span><span class="p">,</span> <span class="n">help</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">rows</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">formatter</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Commands&quot;</span><span class="p">)):</span>
                    <span class="n">formatter</span><span class="o">.</span><span class="n">write_dl</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_args_is_help</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoArgsIsHelpError</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="n">rest</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">_protected_args</span> <span class="o">=</span> <span class="n">rest</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">rest</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">_protected_args</span><span class="p">,</span> <span class="n">ctx</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">rest</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">rest</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">args</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_process_result</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_result_callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_result_callback</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">_protected_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">invoke_without_command</span><span class="p">:</span>
                <span class="c1"># No subcommand was invoked, so the result callback is</span>
                <span class="c1"># invoked with the group return value for regular</span>
                <span class="c1"># groups, or an empty list for chained groups.</span>
                <span class="k">with</span> <span class="n">ctx</span><span class="p">:</span>
                    <span class="n">rv</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">_process_result</span><span class="p">([]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain</span> <span class="k">else</span> <span class="n">rv</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Missing command.&quot;</span><span class="p">))</span>

        <span class="c1"># Fetch args back out</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">ctx</span><span class="o">.</span><span class="n">_protected_args</span><span class="p">,</span> <span class="o">*</span><span class="n">ctx</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">_protected_args</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If we&#39;re not in chain mode, we only allow the invocation of a</span>
        <span class="c1"># single command but we also inform the current context about the</span>
        <span class="c1"># name of the command to invoke.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="p">:</span>
            <span class="c1"># Make sure the context is entered so we do not clean up</span>
            <span class="c1"># resources until the result processor has worked.</span>
            <span class="k">with</span> <span class="n">ctx</span><span class="p">:</span>
                <span class="n">cmd_name</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">invoked_subcommand</span> <span class="o">=</span> <span class="n">cmd_name</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                <span class="n">sub_ctx</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">make_context</span><span class="p">(</span><span class="n">cmd_name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">sub_ctx</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_process_result</span><span class="p">(</span><span class="n">sub_ctx</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">sub_ctx</span><span class="p">))</span>

        <span class="c1"># In chain mode we create the contexts step by step, but after the</span>
        <span class="c1"># base command has been invoked.  Because at that point we do not</span>
        <span class="c1"># know the subcommands yet, the invoked subcommand attribute is</span>
        <span class="c1"># set to ``*`` to inform the command that subcommands are executed</span>
        <span class="c1"># but nothing else.</span>
        <span class="k">with</span> <span class="n">ctx</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">invoked_subcommand</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span> <span class="k">if</span> <span class="n">args</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

            <span class="c1"># Otherwise we make every single context and invoke them in a</span>
            <span class="c1"># chain.  In that case the return value to the result processor</span>
            <span class="c1"># is the list of all invoked subcommand&#39;s results.</span>
            <span class="n">contexts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">args</span><span class="p">:</span>
                <span class="n">cmd_name</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">sub_ctx</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">make_context</span><span class="p">(</span>
                    <span class="n">cmd_name</span><span class="p">,</span>
                    <span class="n">args</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
                    <span class="n">allow_extra_args</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">allow_interspersed_args</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">contexts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_ctx</span><span class="p">)</span>
                <span class="n">args</span><span class="p">,</span> <span class="n">sub_ctx</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">sub_ctx</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="p">[]</span>

            <span class="n">rv</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">sub_ctx</span> <span class="ow">in</span> <span class="n">contexts</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">sub_ctx</span><span class="p">:</span>
                    <span class="n">rv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_ctx</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">sub_ctx</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">_process_result</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_command</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Command</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="n">cmd_name</span> <span class="o">=</span> <span class="n">make_str</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">original_cmd_name</span> <span class="o">=</span> <span class="n">cmd_name</span>

        <span class="c1"># Get the command</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">)</span>

        <span class="c1"># If we can&#39;t find the command but there is a normalization</span>
        <span class="c1"># function available, we try with that one.</span>
        <span class="k">if</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">token_normalize_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd_name</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">token_normalize_func</span><span class="p">(</span><span class="n">cmd_name</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">)</span>

        <span class="c1"># If we don&#39;t find the command we want to show an error message</span>
        <span class="c1"># to the user that it was not provided.  However, there is</span>
        <span class="c1"># something else we should do: if the first argument looks like</span>
        <span class="c1"># an option we want to kick off parsing again for arguments to</span>
        <span class="c1"># resolve things like --help which now should go to the main</span>
        <span class="c1"># place.</span>
        <span class="k">if</span> <span class="n">cmd</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_split_opt</span><span class="p">(</span><span class="n">cmd_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;No such command </span><span class="si">{name!r}</span><span class="s2">.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">original_cmd_name</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cmd_name</span> <span class="k">if</span> <span class="n">cmd</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">shell_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">CompletionItem</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of completions for the incomplete value. Looks</span>
<span class="sd">        at the names of options, subcommands, and chained</span>
<span class="sd">        multi-commands.</span>

<span class="sd">        :param ctx: Invocation context for this command.</span>
<span class="sd">        :param incomplete: Value being completed. May be empty.</span>

<span class="sd">        .. versionadded:: 8.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">click.shell_completion</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompletionItem</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">CompletionItem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">command</span><span class="o">.</span><span class="n">get_short_help_str</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">_complete_visible_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">shell_complete</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">results</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_MultiCommand</span><span class="p">(</span><span class="n">Group</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_FakeSubclassCheck</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. deprecated:: 8.2</span>
<span class="sd">        Will be removed in Click 9.0. Use ``Group`` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<div class="viewcode-block" id="CommandCollection">
<a class="viewcode-back" href="../../click_extra.html#click_extra.CommandCollection">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CommandCollection</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A :class:`Group` that looks up subcommands on other groups. If a command</span>
<span class="sd">    is not found on this group, each registered source is checked in order.</span>
<span class="sd">    Parameters on a source are not added to this group, and a source&#39;s callback</span>
<span class="sd">    is not invoked when invoking its commands. In other words, this &quot;flattens&quot;</span>
<span class="sd">    commands in many groups into this one group.</span>

<span class="sd">    :param name: The name of the group command.</span>
<span class="sd">    :param sources: A list of :class:`Group` objects to look up commands from.</span>
<span class="sd">    :param kwargs: Other arguments passed to :class:`Group`.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        This is a subclass of ``Group``. Commands are looked up first on this</span>
<span class="sd">        group, then each of its sources.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Group</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1">#: The list of registered groups.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Group</span><span class="p">]</span> <span class="o">=</span> <span class="n">sources</span> <span class="ow">or</span> <span class="p">[]</span>

<div class="viewcode-block" id="CommandCollection.add_source">
<a class="viewcode-back" href="../../click_extra.html#click_extra.CommandCollection.add_source">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="n">Group</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a group as a source of commands.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span></div>


<div class="viewcode-block" id="CommandCollection.get_command">
<a class="viewcode-back" href="../../click_extra.html#click_extra.CommandCollection.get_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Command</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rv</span>

        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">get_command</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain</span><span class="p">:</span>
                    <span class="n">_check_nested_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd_name</span><span class="p">,</span> <span class="n">rv</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">rv</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="CommandCollection.list_commands">
<a class="viewcode-back" href="../../click_extra.html#click_extra.CommandCollection.list_commands">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">list_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">rv</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">list_commands</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span></div>
</div>



<span class="k">def</span><span class="w"> </span><span class="nf">_check_iter</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the value is iterable but not a string. Raises a type</span>
<span class="sd">    error, or return an iterator over the value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span>

    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<div class="viewcode-block" id="Parameter">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Parameter</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A parameter to a command comes in two versions: they are either</span>
<span class="sd">    :class:`Option`\s or :class:`Argument`\s.  Other subclasses are currently</span>
<span class="sd">    not supported by design as some of the internals for parsing are</span>
<span class="sd">    intentionally not finalized.</span>

<span class="sd">    Some settings are supported by both options and arguments.</span>

<span class="sd">    :param param_decls: the parameter declarations for this option or</span>
<span class="sd">                        argument.  This is a list of flags or argument</span>
<span class="sd">                        names.</span>
<span class="sd">    :param type: the type that should be used.  Either a :class:`ParamType`</span>
<span class="sd">                 or a Python type.  The latter is converted into the former</span>
<span class="sd">                 automatically if supported.</span>
<span class="sd">    :param required: controls if this is optional or not.</span>
<span class="sd">    :param default: the default value if omitted.  This can also be a callable,</span>
<span class="sd">                    in which case it&#39;s invoked when the default is needed</span>
<span class="sd">                    without any arguments.</span>
<span class="sd">    :param callback: A function to further process or validate the value</span>
<span class="sd">        after type conversion. It is called as ``f(ctx, param, value)``</span>
<span class="sd">        and must return the value. It is called for all sources,</span>
<span class="sd">        including prompts.</span>
<span class="sd">    :param nargs: the number of arguments to match.  If not ``1`` the return</span>
<span class="sd">                  value is a tuple instead of single value.  The default for</span>
<span class="sd">                  nargs is ``1`` (except if the type is a tuple, then it&#39;s</span>
<span class="sd">                  the arity of the tuple). If ``nargs=-1``, all remaining</span>
<span class="sd">                  parameters are collected.</span>
<span class="sd">    :param metavar: how the value is represented in the help page.</span>
<span class="sd">    :param expose_value: if this is `True` then the value is passed onwards</span>
<span class="sd">                         to the command callback and stored on the context,</span>
<span class="sd">                         otherwise it&#39;s skipped.</span>
<span class="sd">    :param is_eager: eager values are processed before non eager ones.  This</span>
<span class="sd">                     should not be set for arguments or it will inverse the</span>
<span class="sd">                     order of processing.</span>
<span class="sd">    :param envvar: environment variable(s) that are used to provide a default value for</span>
<span class="sd">        this parameter. This can be a string or a sequence of strings. If a sequence is</span>
<span class="sd">        given, only the first non-empty environment variable is used for the parameter.</span>
<span class="sd">    :param shell_complete: A function that returns custom shell</span>
<span class="sd">        completions. Used instead of the param&#39;s type completion if</span>
<span class="sd">        given. Takes ``ctx, param, incomplete`` and must return a list</span>
<span class="sd">        of :class:`~click.shell_completion.CompletionItem` or a list of</span>
<span class="sd">        strings.</span>
<span class="sd">    :param deprecated: If ``True`` or non-empty string, issues a message</span>
<span class="sd">                        indicating that the argument is deprecated and highlights</span>
<span class="sd">                        its deprecation in --help. The message can be customized</span>
<span class="sd">                        by using a string as the value. A deprecated parameter</span>
<span class="sd">                        cannot be required, a ValueError will be raised otherwise.</span>

<span class="sd">    .. versionchanged:: 8.2.0</span>
<span class="sd">        Introduction of ``deprecated``.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        Adding duplicate parameter names to a :class:`~click.core.Command` will</span>
<span class="sd">        result in a ``UserWarning`` being shown.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        Adding duplicate parameter names to a :class:`~click.core.Command` will</span>
<span class="sd">        result in a ``UserWarning`` being shown.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        ``process_value`` validates required parameters and bounded</span>
<span class="sd">        ``nargs``, and invokes the parameter callback before returning</span>
<span class="sd">        the value. This allows the callback to validate prompts.</span>
<span class="sd">        ``full_process_value`` is removed.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        ``autocompletion`` is renamed to ``shell_complete`` and has new</span>
<span class="sd">        semantics described above. The old name is deprecated and will</span>
<span class="sd">        be removed in 8.1, until then it will be wrapped to match the</span>
<span class="sd">        new requirements.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        For ``multiple=True, nargs&gt;1``, the default must be a list of</span>
<span class="sd">        tuples.</span>

<span class="sd">    .. versionchanged:: 8.0</span>
<span class="sd">        Setting a default is no longer required for ``nargs&gt;1``, it will</span>
<span class="sd">        default to ``None``. ``multiple=True`` or ``nargs=-1`` will</span>
<span class="sd">        default to ``()``.</span>

<span class="sd">    .. versionchanged:: 7.1</span>
<span class="sd">        Empty environment variables are ignored rather than taking the</span>
<span class="sd">        empty string value. This makes it possible for scripts to clear</span>
<span class="sd">        variables if they can&#39;t unset them.</span>

<span class="sd">    .. versionchanged:: 2.0</span>
<span class="sd">        Changed signature for parameter callback to also be passed the</span>
<span class="sd">        parameter. The old callback format will still work, but it will</span>
<span class="sd">        raise a warning to give you a chance to migrate the code easier.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_type_name</span> <span class="o">=</span> <span class="s2">&quot;parameter&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">param_decls</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ParamType</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="c1"># XXX The default historically embed two concepts:</span>
        <span class="c1"># - the declaration of a Parameter object carrying the default (handy to</span>
        <span class="c1">#   arbitrage the default value of coupled Parameters sharing the same</span>
        <span class="c1">#   self.name, like flag options),</span>
        <span class="c1"># - and the actual value of the default.</span>
        <span class="c1"># It is confusing and is the source of many issues discussed in:</span>
        <span class="c1"># https://github.com/pallets/click/pull/3030</span>
        <span class="c1"># In the future, we might think of splitting it in two, not unlike</span>
        <span class="c1"># Option.is_flag and Option.flag_value: we could have something like</span>
        <span class="c1"># Parameter.is_default and Parameter.default_value.</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">UNSET</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Context</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">nargs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">multiple</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">metavar</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">expose_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_eager</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">envvar</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shell_complete</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="n">Context</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">CompletionItem</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">deprecated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_decls</span><span class="p">(</span>
            <span class="n">param_decls</span> <span class="ow">or</span> <span class="p">(),</span> <span class="n">expose_value</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ParamType</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">convert_type</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

        <span class="c1"># Default nargs to what the type tells us if we have that</span>
        <span class="c1"># information available.</span>
        <span class="k">if</span> <span class="n">nargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">is_composite</span><span class="p">:</span>
                <span class="n">nargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">arity</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="o">=</span> <span class="n">required</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="n">nargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span> <span class="o">=</span> <span class="n">multiple</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expose_value</span> <span class="o">=</span> <span class="n">expose_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_eager</span> <span class="o">=</span> <span class="n">is_eager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="n">metavar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">envvar</span> <span class="o">=</span> <span class="n">envvar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_custom_shell_complete</span> <span class="o">=</span> <span class="n">shell_complete</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span> <span class="o">=</span> <span class="n">deprecated</span>

        <span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">is_composite</span> <span class="ow">and</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">arity</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;nargs&#39; must be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">arity</span><span class="si">}</span><span class="s2"> (or None) for&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">!r}</span><span class="s2">, but it was </span><span class="si">{</span><span class="n">nargs</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">required</span> <span class="ow">and</span> <span class="n">deprecated</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param_type_name</span><span class="si">}</span><span class="s2"> &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">human_readable_name</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                    <span class="s2">&quot;is deprecated and still required. A deprecated &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param_type_name</span><span class="si">}</span><span class="s2"> cannot be required.&quot;</span>
                <span class="p">)</span>

<div class="viewcode-block" id="Parameter.to_info_dict">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.to_info_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_info_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gather information that could be useful for a tool generating</span>
<span class="sd">        user-facing documentation.</span>

<span class="sd">        Use :meth:`click.Context.to_info_dict` to traverse the entire</span>
<span class="sd">        CLI structure.</span>

<span class="sd">        .. versionchanged:: 8.3.0</span>
<span class="sd">            Returns ``None`` for the :attr:`default` if it was not set.</span>

<span class="sd">        .. versionadded:: 8.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;param_type_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_type_name</span><span class="p">,</span>
            <span class="s2">&quot;opts&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span>
            <span class="s2">&quot;secondary_opts&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">to_info_dict</span><span class="p">(),</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">,</span>
            <span class="s2">&quot;nargs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span><span class="p">,</span>
            <span class="s2">&quot;multiple&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span><span class="p">,</span>
            <span class="c1"># We explicitly hide the :attr:`UNSET` value to the user, as we choose to</span>
            <span class="c1"># make it an implementation detail. And because ``to_info_dict`` has been</span>
            <span class="c1"># designed for documentation purposes, we return ``None`` instead.</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;envvar&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">envvar</span><span class="p">,</span>
        <span class="p">}</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_decls</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">decls</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">expose_value</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">human_readable_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the human readable name of this parameter.  This is the</span>
<span class="sd">        same as the name for options, but the metavar for arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># type: ignore</span>

<div class="viewcode-block" id="Parameter.make_metavar">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.make_metavar">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_metavar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span>

        <span class="n">metavar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">get_metavar</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">metavar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metavar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">metavar</span> <span class="o">+=</span> <span class="s2">&quot;...&quot;</span>

        <span class="k">return</span> <span class="n">metavar</span></div>


    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@t</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="o">...</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

<div class="viewcode-block" id="Parameter.get_default">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.get_default">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">call</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[],</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the default for the parameter. Tries</span>
<span class="sd">        :meth:`Context.lookup_default` first, then the local default.</span>

<span class="sd">        :param ctx: Current context.</span>
<span class="sd">        :param call: If the default is a callable, call it. Disable to</span>
<span class="sd">            return the callable instead.</span>

<span class="sd">        .. versionchanged:: 8.0.2</span>
<span class="sd">            Type casting is no longer performed when getting a default.</span>

<span class="sd">        .. versionchanged:: 8.0.1</span>
<span class="sd">            Type casting can fail in resilient parsing mode. Invalid</span>
<span class="sd">            defaults will not prevent showing help text.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Looks at ``ctx.default_map`` first.</span>

<span class="sd">        .. versionchanged:: 8.0</span>
<span class="sd">            Added the ``call`` parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">lookup_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">call</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span>

        <span class="k">if</span> <span class="n">call</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="Parameter.add_to_parser">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.add_to_parser">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">_OptionParser</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">consume_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">opts</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the parameter value produced by the parser.</span>

<span class="sd">        If the parser did not produce a value from user input, the value is either</span>
<span class="sd">        sourced from the environment variable, the default map, or the parameter&#39;s</span>
<span class="sd">        default value. In that order of precedence.</span>

<span class="sd">        If no value is found, an internal sentinel value is returned.</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Collect from the parse the value passed by the user to the CLI.</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">UNSET</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># If the value is set, it means it was sourced from the command line by the</span>
        <span class="c1"># parser, otherwise it left unset by default.</span>
        <span class="n">source</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ParameterSource</span><span class="o">.</span><span class="n">COMMANDLINE</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span>
            <span class="k">else</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="n">envvar_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_from_envvar</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">envvar_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">envvar_value</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">ENVIRONMENT</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="n">default_map_value</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">lookup_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="k">if</span> <span class="n">default_map_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">default_map_value</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT_MAP</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">default_value</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT</span>

        <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">source</span>

<div class="viewcode-block" id="Parameter.type_cast_value">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.type_cast_value">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">type_cast_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert and validate a value against the parameter&#39;s</span>
<span class="sd">        :attr:`type`, :attr:`multiple`, and :attr:`nargs`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">check_iter</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_check_iter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># This should only happen when passing in args manually,</span>
                <span class="c1"># the parser should construct an iterable when parsing</span>
                <span class="c1"># the command line.</span>
                <span class="k">raise</span> <span class="n">BadParameter</span><span class="p">(</span>
                    <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Value must be an iterable.&quot;</span><span class="p">),</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="bp">self</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="kc">None</span>

        <span class="c1"># Define the conversion function based on nargs and type.</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">is_composite</span><span class="p">:</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>  <span class="c1"># tuple[t.Any, ...]</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">check_iter</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># nargs &gt; 1</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>  <span class="c1"># tuple[t.Any, ...]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">check_iter</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">BadParameter</span><span class="p">(</span>
                        <span class="n">ngettext</span><span class="p">(</span>
                            <span class="s2">&quot;Takes </span><span class="si">{nargs}</span><span class="s2"> values but 1 was given.&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Takes </span><span class="si">{nargs}</span><span class="s2"> values but </span><span class="si">{len}</span><span class="s2"> were given.&quot;</span><span class="p">,</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nargs</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span>
                        <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">check_iter</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">value_is_missing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A value is considered missing if:</span>

<span class="sd">        - it is :attr:`UNSET`,</span>
<span class="sd">        - or if it is an empty sequence while the parameter is suppose to have</span>
<span class="sd">          non-single value (i.e. :attr:`nargs` is not ``1`` or :attr:`multiple` is</span>
<span class="sd">          set).</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the value of this parameter:</span>

<span class="sd">        1. Type cast the value using :meth:`type_cast_value`.</span>
<span class="sd">        2. Check if the value is missing (see: :meth:`value_is_missing`), and raise</span>
<span class="sd">           :exc:`MissingParameter` if it is required.</span>
<span class="sd">        3. If a :attr:`callback` is set, call it to have the value replaced by the</span>
<span class="sd">           result of the callback. If the value was not set, the callback receive</span>
<span class="sd">           ``None``. This keep the legacy behavior as it was before the introduction of</span>
<span class="sd">           the :attr:`UNSET` sentinel.</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># shelter `type_cast_value` from ever seeing an `UNSET` value by handling the</span>
        <span class="c1"># cases in which `UNSET` gets special treatment explicitly at this layer</span>
        <span class="c1">#</span>
        <span class="c1"># Refs:</span>
        <span class="c1"># https://github.com/pallets/click/issues/3069</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_cast_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_is_missing</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">MissingParameter</span><span class="p">(</span><span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Legacy case: UNSET is not exposed directly to the callback, but converted</span>
            <span class="c1"># to None.</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># Search for parameters with UNSET values in the context.</span>
            <span class="n">unset_keys</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">}</span>
            <span class="c1"># No UNSET values, call the callback as usual.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">unset_keys</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="c1"># Legacy case: provide a temporarily manipulated context to the callback</span>
            <span class="c1"># to hide UNSET values as None.</span>
            <span class="c1">#</span>
            <span class="c1"># Refs:</span>
            <span class="c1"># https://github.com/pallets/click/issues/3136</span>
            <span class="c1"># https://github.com/pallets/click/pull/3137</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Add another layer to the context stack to clearly hint that the</span>
                <span class="c1"># context is temporarily modified.</span>
                <span class="k">with</span> <span class="n">ctx</span><span class="p">:</span>
                    <span class="c1"># Update the context parameters to replace UNSET with None.</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">unset_keys</span><span class="p">)</span>
                    <span class="c1"># Feed these fake context parameters to the callback.</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="c1"># Restore the UNSET values in the context parameters.</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="n">k</span><span class="p">:</span> <span class="n">UNSET</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">unset_keys</span>
                            <span class="c1"># Only restore keys that are present and still None, in case</span>
                            <span class="c1"># the callback modified other parameters.</span>
                            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span> <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
                        <span class="p">}</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_envvar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the value found in the environment variable(s) attached to this</span>
<span class="sd">        parameter.</span>

<span class="sd">        Environment variables values are `always returned as strings</span>
<span class="sd">        &lt;https://docs.python.org/3/library/os.html#os.environ&gt;`_.</span>

<span class="sd">        This method returns ``None`` if:</span>

<span class="sd">        - the :attr:`envvar` property is not set on the :class:`Parameter`,</span>
<span class="sd">        - the environment variable is not found in the environment,</span>
<span class="sd">        - the variable is found in the environment but its value is empty (i.e. the</span>
<span class="sd">          environment variable is present but has an empty string).</span>

<span class="sd">        If :attr:`envvar` is setup with multiple environment variables,</span>
<span class="sd">        then only the first non-empty value is returned.</span>

<span class="sd">        .. caution::</span>

<span class="sd">            The raw value extracted from the environment is not normalized and is</span>
<span class="sd">            returned as-is. Any normalization or reconciliation is performed later by</span>
<span class="sd">            the :class:`Parameter`&#39;s :attr:`type`.</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">envvar</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">envvar</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">envvar</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">rv</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">rv</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">envvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">envvar</span><span class="p">:</span>
                <span class="n">rv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">envvar</span><span class="p">)</span>

                <span class="c1"># Return the first non-empty value of the list of environment variables.</span>
                <span class="k">if</span> <span class="n">rv</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">rv</span>
                <span class="c1"># Else, absence of value is interpreted as an environment variable that</span>
                <span class="c1"># is not set, so proceed to the next one.</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">value_from_envvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the raw environment variable string for this parameter.</span>

<span class="sd">        Returns the string as-is or splits it into a sequence of strings if the</span>
<span class="sd">        parameter is expecting multiple values (i.e. its :attr:`nargs` property is set</span>
<span class="sd">        to a value other than ``1``).</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_envvar_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">split_envvar_value</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">handle_parse_result</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">opts</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the value produced by the parser from user input.</span>

<span class="sd">        Always process the value through the Parameter&#39;s :attr:`type`, wherever it</span>
<span class="sd">        comes from.</span>

<span class="sd">        If the parameter is deprecated, this method warn the user about it. But only if</span>
<span class="sd">        the value has been explicitly set by the user (and as such, is not coming from</span>
<span class="sd">        a default).</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">augment_usage_errors</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consume_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>

            <span class="n">ctx</span><span class="o">.</span><span class="n">set_parameter_source</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

            <span class="c1"># Display a deprecation warning if necessary.</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span>
                <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span>
                <span class="ow">and</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT_MAP</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">extra_message</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
                <span class="n">message</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span>
                    <span class="s2">&quot;DeprecationWarning: The </span><span class="si">{param_type}</span><span class="s2"> </span><span class="si">{name!r}</span><span class="s2"> is deprecated.&quot;</span>
                    <span class="s2">&quot;</span><span class="si">{extra_message}</span><span class="s2">&quot;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">param_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_type_name</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">human_readable_name</span><span class="p">,</span>
                    <span class="n">extra_message</span><span class="o">=</span><span class="n">extra_message</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">echo</span><span class="p">(</span><span class="n">style</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span> <span class="n">err</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Process the value through the parameter&#39;s type.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span>
                    <span class="k">raise</span>
                <span class="c1"># In resilient parsing mode, we do not want to fail the command if the</span>
                <span class="c1"># value is incompatible with the parameter type, so we reset the value</span>
                <span class="c1"># to UNSET, which will be interpreted as a missing value.</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">UNSET</span>

        <span class="c1"># Add parameter&#39;s value to the context.</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expose_value</span>
            <span class="c1"># We skip adding the value if it was previously set by another parameter</span>
            <span class="c1"># targeting the same variable name. This prevents parameters competing for</span>
            <span class="c1"># the same name to override each other.</span>
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span> <span class="ow">or</span> <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># Click is logically enforcing that the name is None if the parameter is</span>
            <span class="c1"># not to be exposed. We still assert it here to please the type checker.</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="si">!r}</span><span class="s2"> parameter&#39;s name should not be None when exposing value.&quot;</span>
            <span class="p">)</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">args</span>

<div class="viewcode-block" id="Parameter.get_help_record">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.get_help_record">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_help_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="Parameter.get_usage_pieces">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.get_usage_pieces">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_usage_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Parameter.get_error_hint">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.get_error_hint">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_error_hint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a stringified version of the param for use in error messages to</span>
<span class="sd">        indicate which param caused the error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hint_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opts</span> <span class="ow">or</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">human_readable_name</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot; / &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hint_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="Parameter.shell_complete">
<a class="viewcode-back" href="../../click_extra.html#click_extra.Parameter.shell_complete">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shell_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">CompletionItem</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of completions for the incomplete value. If a</span>
<span class="sd">        ``shell_complete`` function was given during init, it is used.</span>
<span class="sd">        Otherwise, the :attr:`type`</span>
<span class="sd">        :meth:`~click.types.ParamType.shell_complete` function is used.</span>

<span class="sd">        :param ctx: Invocation context for this command.</span>
<span class="sd">        :param incomplete: Value being completed. May be empty.</span>

<span class="sd">        .. versionadded:: 8.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_shell_complete</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_custom_shell_complete</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">results</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">click.shell_completion</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompletionItem</span>

                <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">CompletionItem</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;list[CompletionItem]&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">shell_complete</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">)</span></div>
</div>



<span class="k">class</span><span class="w"> </span><span class="nc">Option</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Options are usually optional values on the command line and</span>
<span class="sd">    have some extra features that arguments don&#39;t have.</span>

<span class="sd">    All other parameters are passed onwards to the parameter constructor.</span>

<span class="sd">    :param show_default: Show the default value for this option in its</span>
<span class="sd">        help text. Values are not shown by default, unless</span>
<span class="sd">        :attr:`Context.show_default` is ``True``. If this value is a</span>
<span class="sd">        string, it shows that string in parentheses instead of the</span>
<span class="sd">        actual value. This is particularly useful for dynamic options.</span>
<span class="sd">        For single option boolean flags, the default remains hidden if</span>
<span class="sd">        its value is ``False``.</span>
<span class="sd">    :param show_envvar: Controls if an environment variable should be</span>
<span class="sd">        shown on the help page and error messages.</span>
<span class="sd">        Normally, environment variables are not shown.</span>
<span class="sd">    :param prompt: If set to ``True`` or a non empty string then the</span>
<span class="sd">        user will be prompted for input. If set to ``True`` the prompt</span>
<span class="sd">        will be the option name capitalized. A deprecated option cannot be</span>
<span class="sd">        prompted.</span>
<span class="sd">    :param confirmation_prompt: Prompt a second time to confirm the</span>
<span class="sd">        value if it was prompted for. Can be set to a string instead of</span>
<span class="sd">        ``True`` to customize the message.</span>
<span class="sd">    :param prompt_required: If set to ``False``, the user will be</span>
<span class="sd">        prompted for input only when the option was specified as a flag</span>
<span class="sd">        without a value.</span>
<span class="sd">    :param hide_input: If this is ``True`` then the input on the prompt</span>
<span class="sd">        will be hidden from the user. This is useful for password input.</span>
<span class="sd">    :param is_flag: forces this option to act as a flag.  The default is</span>
<span class="sd">                    auto detection.</span>
<span class="sd">    :param flag_value: which value should be used for this flag if it&#39;s</span>
<span class="sd">                       enabled.  This is set to a boolean automatically if</span>
<span class="sd">                       the option string contains a slash to mark two options.</span>
<span class="sd">    :param multiple: if this is set to `True` then the argument is accepted</span>
<span class="sd">                     multiple times and recorded.  This is similar to ``nargs``</span>
<span class="sd">                     in how it works but supports arbitrary number of</span>
<span class="sd">                     arguments.</span>
<span class="sd">    :param count: this flag makes an option increment an integer.</span>
<span class="sd">    :param allow_from_autoenv: if this is enabled then the value of this</span>
<span class="sd">                               parameter will be pulled from an environment</span>
<span class="sd">                               variable in case a prefix is defined on the</span>
<span class="sd">                               context.</span>
<span class="sd">    :param help: the help string.</span>
<span class="sd">    :param hidden: hide this option from help outputs.</span>
<span class="sd">    :param attrs: Other command arguments described in :class:`Parameter`.</span>

<span class="sd">    .. versionchanged:: 8.2</span>
<span class="sd">        ``envvar`` used with ``flag_value`` will always use the ``flag_value``,</span>
<span class="sd">        previously it would use the value of the environment variable.</span>

<span class="sd">    .. versionchanged:: 8.1</span>
<span class="sd">        Help text indentation is cleaned here instead of only in the</span>
<span class="sd">        ``@option`` decorator.</span>

<span class="sd">    .. versionchanged:: 8.1</span>
<span class="sd">        The ``show_default`` parameter overrides</span>
<span class="sd">        ``Context.show_default``.</span>

<span class="sd">    .. versionchanged:: 8.1</span>
<span class="sd">        The default of a single option boolean flag is not shown if the</span>
<span class="sd">        default value is ``False``.</span>

<span class="sd">    .. versionchanged:: 8.0.1</span>
<span class="sd">        ``type`` is detected from ``flag_value`` if given.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_type_name</span> <span class="o">=</span> <span class="s2">&quot;option&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">param_decls</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">confirmation_prompt</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">prompt_required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">hide_input</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">flag_value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">UNSET</span><span class="p">,</span>
        <span class="n">multiple</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">count</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">allow_from_autoenv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ParamType</span> <span class="o">|</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">help</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hidden</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">show_choices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">show_envvar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">deprecated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">attrs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">help</span><span class="p">:</span>
            <span class="n">help</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="n">help</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">param_decls</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="n">multiple</span><span class="p">,</span> <span class="n">deprecated</span><span class="o">=</span><span class="n">deprecated</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">prompt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;name&#39; is required with &#39;prompt=True&#39;.&quot;</span><span class="p">)</span>

            <span class="n">prompt_text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">prompt</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">prompt_text</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prompt_text</span> <span class="o">=</span> <span class="n">prompt</span>

        <span class="k">if</span> <span class="n">deprecated</span><span class="p">:</span>
            <span class="n">deprecated_message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;(DEPRECATED: </span><span class="si">{</span><span class="n">deprecated</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">deprecated</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;(DEPRECATED)&quot;</span>
            <span class="p">)</span>
            <span class="n">help</span> <span class="o">=</span> <span class="n">help</span> <span class="o">+</span> <span class="n">deprecated_message</span> <span class="k">if</span> <span class="n">help</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">deprecated_message</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="n">prompt_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confirmation_prompt</span> <span class="o">=</span> <span class="n">confirmation_prompt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prompt_required</span> <span class="o">=</span> <span class="n">prompt_required</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hide_input</span> <span class="o">=</span> <span class="n">hide_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">hidden</span>

        <span class="c1"># The _flag_needs_value property tells the parser that this option is a flag</span>
        <span class="c1"># that cannot be used standalone and needs a value. With this information, the</span>
        <span class="c1"># parser can determine whether to consider the next user-provided argument in</span>
        <span class="c1"># the CLI as a value for this flag or as a new option.</span>
        <span class="c1"># If prompt is enabled but not required, then it opens the possibility for the</span>
        <span class="c1"># option to gets its value from the user.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_needs_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_required</span>

        <span class="c1"># Auto-detect if this is a flag or not.</span>
        <span class="k">if</span> <span class="n">is_flag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Implicitly a flag because flag_value was set.</span>
            <span class="k">if</span> <span class="n">flag_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="n">is_flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Not a flag, but when used as a flag it shows a prompt.</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_needs_value</span><span class="p">:</span>
                <span class="n">is_flag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Implicitly a flag because secondary options names were given.</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">:</span>
                <span class="n">is_flag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># The option is explicitly not a flag. But we do not know yet if it needs a</span>
        <span class="c1"># value or not. So we look at the default value to determine it.</span>
        <span class="k">elif</span> <span class="n">is_flag</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_needs_value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_needs_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">UNSET</span>

        <span class="k">if</span> <span class="n">is_flag</span><span class="p">:</span>
            <span class="c1"># Set missing default for flags if not explicitly required or prompted.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">UNSET</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">multiple</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="p">()</span>

            <span class="c1"># Auto-detect the type of the flag based on the flag_value.</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># A flag without a flag_value is a boolean flag.</span>
                <span class="k">if</span> <span class="n">flag_value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">ParamType</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">BoolParamType</span><span class="p">()</span>
                <span class="c1"># If the flag value is a boolean, use BoolParamType.</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag_value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">BoolParamType</span><span class="p">()</span>
                <span class="c1"># Otherwise, guess the type from the flag value.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">convert_type</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag_value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">is_flag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span>
            <span class="n">is_flag</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">BoolParamType</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">flag_value</span>

        <span class="c1"># Set boolean flag default to False if unset and not required.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">UNSET</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Support the special case of aligning the default value with the flag_value</span>
        <span class="c1"># for flags whose default is explicitly set to True. Note that as long as we</span>
        <span class="c1"># have this condition, there is no way a flag can have a default set to True,</span>
        <span class="c1"># and a flag_value set to something else. Refs:</span>
        <span class="c1"># https://github.com/pallets/click/issues/3024#issuecomment-3146199461</span>
        <span class="c1"># https://github.com/pallets/click/pull/3030/commits/06847da</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span>

        <span class="c1"># Set the default flag_value if it is not set.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Counting.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="k">if</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">IntRange</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allow_from_autoenv</span> <span class="o">=</span> <span class="n">allow_from_autoenv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="n">help</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span> <span class="o">=</span> <span class="n">show_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_choices</span> <span class="o">=</span> <span class="n">show_choices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_envvar</span> <span class="o">=</span> <span class="n">show_envvar</span>

        <span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">deprecated</span> <span class="ow">and</span> <span class="n">prompt</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`deprecated` options cannot use `prompt`.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;nargs=-1 is not supported for options.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Secondary flag is not valid for non-boolean flag.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_input</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;prompt&#39; with &#39;hide_input&#39; is not valid for boolean flag.&quot;</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;count&#39; is not valid with &#39;multiple&#39;.&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;count&#39; is not valid with &#39;is_flag&#39;.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_info_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. versionchanged:: 8.3.0</span>
<span class="sd">            Returns ``None`` for the :attr:`flag_value` if it was not set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">to_info_dict</span><span class="p">()</span>
        <span class="n">info_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">help</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">,</span>
            <span class="n">prompt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">,</span>
            <span class="n">is_flag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span><span class="p">,</span>
            <span class="c1"># We explicitly hide the :attr:`UNSET` value to the user, as we choose to</span>
            <span class="c1"># make it an implementation detail. And because ``to_info_dict`` has been</span>
            <span class="c1"># designed for documentation purposes, we return ``None`` instead.</span>
            <span class="n">flag_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">,</span>
            <span class="n">hidden</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">info_dict</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_error_hint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_error_hint</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_envvar</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">envvar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (env var: &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">envvar</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_decls</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">decls</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">expose_value</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">secondary_opts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">possible_names</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">decl</span> <span class="ow">in</span> <span class="n">decls</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">decl</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; defined twice&quot;</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">decl</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">split_char</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span> <span class="k">if</span> <span class="n">decl</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span> <span class="k">else</span> <span class="s2">&quot;/&quot;</span>
                <span class="k">if</span> <span class="n">split_char</span> <span class="ow">in</span> <span class="n">decl</span><span class="p">:</span>
                    <span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">decl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">split_char</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                        <span class="n">possible_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_split_opt</span><span class="p">(</span><span class="n">first</span><span class="p">))</span>
                        <span class="n">opts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
                    <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">second</span><span class="p">:</span>
                        <span class="n">secondary_opts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">first</span> <span class="o">==</span> <span class="n">second</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Boolean option </span><span class="si">{</span><span class="n">decl</span><span class="si">!r}</span><span class="s2"> cannot use the&quot;</span>
                            <span class="s2">&quot; same flag for true/false.&quot;</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">possible_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_split_opt</span><span class="p">(</span><span class="n">decl</span><span class="p">))</span>
                    <span class="n">opts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decl</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">possible_names</span><span class="p">:</span>
            <span class="n">possible_names</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># group long options first</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">possible_names</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">isidentifier</span><span class="p">():</span>
                <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">expose_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">secondary_opts</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not determine name for option with declarations </span><span class="si">{</span><span class="n">decls</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">opts</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">secondary_opts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No options defined but a name was passed (</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">).&quot;</span>
                <span class="s2">&quot; Did you mean to declare an argument instead? Did&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; you mean to pass &#39;--</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;?&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">secondary_opts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">_OptionParser</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;append&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;count&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;store&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">_const&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">:</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">opts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">opts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">,</span>
                    <span class="n">dest</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
                    <span class="n">const</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">opts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span>
                    <span class="n">dest</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
                    <span class="n">const</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
                <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">opts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">,</span>
                <span class="n">dest</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
                <span class="n">nargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nargs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_help_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">any_prefix_is_slash</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_write_opts</span><span class="p">(</span><span class="n">opts</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">nonlocal</span> <span class="n">any_prefix_is_slash</span>

            <span class="n">rv</span><span class="p">,</span> <span class="n">any_slashes</span> <span class="o">=</span> <span class="n">join_options</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">any_slashes</span><span class="p">:</span>
                <span class="n">any_prefix_is_slash</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="n">rv</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_metavar</span><span class="p">(</span><span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">return</span> <span class="n">rv</span>

        <span class="n">rv</span> <span class="o">=</span> <span class="p">[</span><span class="n">_write_opts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">:</span>
            <span class="n">rv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_write_opts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">))</span>

        <span class="n">help</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>

        <span class="n">extra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_help_extra</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">extra_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;envvars&quot;</span> <span class="ow">in</span> <span class="n">extra</span><span class="p">:</span>
            <span class="n">extra_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s2">&quot;env var: </span><span class="si">{var}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra</span><span class="p">[</span><span class="s2">&quot;envvars&quot;</span><span class="p">]))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;default&quot;</span> <span class="ow">in</span> <span class="n">extra</span><span class="p">:</span>
            <span class="n">extra_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;default: </span><span class="si">{default}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">extra</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="s2">&quot;range&quot;</span> <span class="ow">in</span> <span class="n">extra</span><span class="p">:</span>
            <span class="n">extra_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extra</span><span class="p">[</span><span class="s2">&quot;range&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;required&quot;</span> <span class="ow">in</span> <span class="n">extra</span><span class="p">:</span>
            <span class="n">extra_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="n">extra</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">extra_items</span><span class="p">:</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra_items</span><span class="p">)</span>
            <span class="n">help</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">help</span><span class="si">}</span><span class="s2">  [</span><span class="si">{</span><span class="n">extra_str</span><span class="si">}</span><span class="s2">]&quot;</span> <span class="k">if</span> <span class="n">help</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">extra_str</span><span class="si">}</span><span class="s2">]&quot;</span>

        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;; &quot;</span> <span class="k">if</span> <span class="n">any_prefix_is_slash</span> <span class="k">else</span> <span class="s2">&quot; / &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="n">help</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_help_extra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">types</span><span class="o">.</span><span class="n">OptionHelpExtra</span><span class="p">:</span>
        <span class="n">extra</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">OptionHelpExtra</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_envvar</span><span class="p">:</span>
            <span class="n">envvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">envvar</span>

            <span class="k">if</span> <span class="n">envvar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">allow_from_autoenv</span>
                    <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">auto_envvar_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="n">envvar</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ctx</span><span class="o">.</span><span class="n">auto_envvar_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">if</span> <span class="n">envvar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">envvar</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;envvars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">envvar</span><span class="p">,)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;envvars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">envvar</span><span class="p">)</span>

        <span class="c1"># Temporarily enable resilient parsing to avoid type casting</span>
        <span class="c1"># failing for the default. Might be possible to extend this to</span>
        <span class="c1"># help formatting in general.</span>
        <span class="n">resilient</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">call</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span> <span class="o">=</span> <span class="n">resilient</span>

        <span class="n">show_default</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">show_default_is_str</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_default</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">show_default_is_str</span> <span class="o">=</span> <span class="n">show_default</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">show_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span>
        <span class="k">elif</span> <span class="n">ctx</span><span class="o">.</span><span class="n">show_default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">show_default</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">show_default</span>

        <span class="k">if</span> <span class="n">show_default_is_str</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">show_default</span> <span class="ow">and</span> <span class="p">(</span><span class="n">default_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">UNSET</span><span class="p">))</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">show_default_is_str</span><span class="p">:</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">show_default</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">default_value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default_value</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="n">default_value</span><span class="o">.</span><span class="n">name</span>
            <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">default_value</span><span class="p">):</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;(dynamic)&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">:</span>
                <span class="c1"># For boolean flags that have distinct True/False opts,</span>
                <span class="c1"># use the opt without prefix instead of the value.</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="n">_split_opt</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opts</span> <span class="k">if</span> <span class="n">default_value</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_opts</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">default_value</span><span class="p">:</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">elif</span> <span class="n">default_value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="s1">&#39;&quot;&quot;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">default_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">default_value</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">default_string</span><span class="p">:</span>
                <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_string</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">_NumberRangeBase</span><span class="p">)</span>
            <span class="c1"># skip count with default range type</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">min</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">range_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">_describe_range</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">range_str</span><span class="p">:</span>
                <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;range&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">range_str</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="n">extra</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;required&quot;</span>

        <span class="k">return</span> <span class="n">extra</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prompt_for_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This is an alternative flow that can be activated in the full</span>
<span class="sd">        value processing if a value does not exist.  It will prompt the</span>
<span class="sd">        user until a valid value exists and then returns the processed</span>
<span class="sd">        value as result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="c1"># Calculate the default before prompting anything to lock in the value before</span>
        <span class="c1"># attempting any user interaction.</span>
        <span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="c1"># A boolean flag can use a simplified [y/n] confirmation prompt.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span><span class="p">:</span>
            <span class="c1"># If we have no boolean default, we force the user to explicitly provide</span>
            <span class="c1"># one.</span>
            <span class="k">if</span> <span class="n">default</span> <span class="ow">in</span> <span class="p">(</span><span class="n">UNSET</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">default</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># Nothing prevent you to declare an option that is simultaneously:</span>
            <span class="c1"># 1) auto-detected as a boolean flag,</span>
            <span class="c1"># 2) allowed to prompt, and</span>
            <span class="c1"># 3) still declare a non-boolean default.</span>
            <span class="c1"># This forced casting into a boolean is necessary to align any non-boolean</span>
            <span class="c1"># default to the prompt, which is going to be a [y/n]-style confirmation</span>
            <span class="c1"># because the option is still a boolean flag. That way, instead of [y/n],</span>
            <span class="c1"># we get [Y/n] or [y/N] depending on the truthy value of the default.</span>
            <span class="c1"># Refs: https://github.com/pallets/click/pull/3030#discussion_r2289180249</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">default</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">confirm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

        <span class="c1"># If show_default is set to True/False, provide this to `prompt` as well. For</span>
        <span class="c1"># non-bool values of `show_default`, we use `prompt`&#39;s default behavior</span>
        <span class="n">prompt_kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_default</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">prompt_kwargs</span><span class="p">[</span><span class="s2">&quot;show_default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_default</span>

        <span class="k">return</span> <span class="n">prompt</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">,</span>
            <span class="c1"># Use ``None`` to inform the prompt() function to reiterate until a valid</span>
            <span class="c1"># value is provided by the user if we have no default.</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">UNSET</span> <span class="k">else</span> <span class="n">default</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
            <span class="n">hide_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hide_input</span><span class="p">,</span>
            <span class="n">show_choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_choices</span><span class="p">,</span>
            <span class="n">confirmation_prompt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">confirmation_prompt</span><span class="p">,</span>
            <span class="n">value_proc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
            <span class="o">**</span><span class="n">prompt_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_envvar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;:class:`Option` resolves its environment variable the same way as</span>
<span class="sd">        :func:`Parameter.resolve_envvar_value`, but it also supports</span>
<span class="sd">        :attr:`Context.auto_envvar_prefix`. If we could not find an environment from</span>
<span class="sd">        the :attr:`envvar` property, we fallback on :attr:`Context.auto_envvar_prefix`</span>
<span class="sd">        to build dynamiccaly the environment variable name using the</span>
<span class="sd">        :python:`{ctx.auto_envvar_prefix}_{self.name.upper()}` template.</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">resolve_envvar_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rv</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_from_autoenv</span>
            <span class="ow">and</span> <span class="n">ctx</span><span class="o">.</span><span class="n">auto_envvar_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">envvar</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ctx</span><span class="o">.</span><span class="n">auto_envvar_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">rv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">envvar</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">rv</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">rv</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">value_from_envvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For :class:`Option`, this method processes the raw environment variable</span>
<span class="sd">        string the same way as :func:`Parameter.value_from_envvar` does.</span>

<span class="sd">        But in the case of non-boolean flags, the value is analyzed to determine if the</span>
<span class="sd">        flag is activated or not, and returns a boolean of its activation, or the</span>
<span class="sd">        :attr:`flag_value` if the latter is set.</span>

<span class="sd">        This method also takes care of repeated options (i.e. options with</span>
<span class="sd">        :attr:`multiple` set to ``True``).</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_envvar_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>

        <span class="c1"># Absent environment variable or an empty string is interpreted as unset.</span>
        <span class="k">if</span> <span class="n">rv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Non-boolean flags are more liberal in what they accept. But a flag being a</span>
        <span class="c1"># flag, its envvar value still needs to be analyzed to determine if the flag is</span>
        <span class="c1"># activated or not.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span><span class="p">:</span>
            <span class="c1"># If the flag_value is set and match the envvar value, return it</span>
            <span class="c1"># directly.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span>
            <span class="c1"># Analyze the envvar value as a boolean to know if the flag is</span>
            <span class="c1"># activated or not.</span>
            <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">BoolParamType</span><span class="o">.</span><span class="n">str_to_bool</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

        <span class="c1"># Split the envvar value if it is allowed to be repeated.</span>
        <span class="n">value_depth</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value_depth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">multi_rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">split_envvar_value</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">multi_rv</span> <span class="o">=</span> <span class="n">batch</span><span class="p">(</span><span class="n">multi_rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>

            <span class="k">return</span> <span class="n">multi_rv</span>

        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">consume_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">opts</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For :class:`Option`, the value can be collected from an interactive prompt</span>
<span class="sd">        if the option is a flag that needs a value (and the :attr:`prompt` property is</span>
<span class="sd">        set).</span>

<span class="sd">        Additionally, this method handles flag option that are activated without a</span>
<span class="sd">        value, in which case the :attr:`flag_value` is returned.</span>

<span class="sd">        :meta private:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">source</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">consume_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>

        <span class="c1"># The parser will emit a sentinel value if the option is allowed to as a flag</span>
        <span class="c1"># without a value.</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">FLAG_NEEDS_VALUE</span><span class="p">:</span>
            <span class="c1"># If the option allows for a prompt, we start an interaction with the user.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_for_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">PROMPT</span>
            <span class="c1"># Else the flag takes its flag_value as value.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">COMMANDLINE</span>

        <span class="c1"># A flag which is activated always returns the flag value, unless the value</span>
        <span class="c1"># comes from the explicitly sets default.</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span>
            <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">True</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span>
            <span class="ow">and</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT_MAP</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span>

        <span class="c1"># Re-interpret a multiple option which has been sent as-is by the parser.</span>
        <span class="c1"># Here we replace each occurrence of value-less flags (marked by the</span>
        <span class="c1"># FLAG_NEEDS_VALUE sentinel) with the flag_value.</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiple</span>
            <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">UNSET</span>
            <span class="ow">and</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT_MAP</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="n">FLAG_NEEDS_VALUE</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">flag_value</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="n">FLAG_NEEDS_VALUE</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">COMMANDLINE</span>

        <span class="c1"># The value wasn&#39;t set, or used the param&#39;s default, prompt for one to the user</span>
        <span class="c1"># if prompting is enabled.</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span>
                <span class="ow">or</span> <span class="n">source</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">DEFAULT_MAP</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_required</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">resilient_parsing</span>
        <span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prompt_for_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">ParameterSource</span><span class="o">.</span><span class="n">PROMPT</span>

        <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">source</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="c1"># process_value has to be overridden on Options in order to capture</span>
        <span class="c1"># `value == UNSET` cases before `type_cast_value()` gets called.</span>
        <span class="c1">#</span>
        <span class="c1"># Refs:</span>
        <span class="c1"># https://github.com/pallets/click/issues/3069</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_flag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bool_flag</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">value</span>

        <span class="c1"># in the normal case, rely on Parameter.process_value</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">process_value</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Argument</span><span class="p">(</span><span class="n">Parameter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Arguments are positional parameters to a command.  They generally</span>
<span class="sd">    provide fewer features than options but can have infinite ``nargs``</span>
<span class="sd">    and are required by default.</span>

<span class="sd">    All parameters are passed onwards to the constructor of :class:`Parameter`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">param_type_name</span> <span class="o">=</span> <span class="s2">&quot;argument&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">param_decls</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">attrs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Auto-detect the requirement status of the argument if not explicitly set.</span>
        <span class="k">if</span> <span class="n">required</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># The argument gets automatically required if it has no explicit default</span>
            <span class="c1"># value set and is setup to match at least one value.</span>
            <span class="k">if</span> <span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">UNSET</span><span class="p">)</span> <span class="ow">is</span> <span class="n">UNSET</span><span class="p">:</span>
                <span class="n">required</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nargs&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="c1"># If the argument has a default value, it is not required.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">required</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s2">&quot;multiple&quot;</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;__init__() got an unexpected keyword argument &#39;multiple&#39;.&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">param_decls</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="n">required</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">human_readable_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_metavar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">get_metavar</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deprecated</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">+=</span> <span class="s2">&quot;!&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">+=</span> <span class="s2">&quot;...&quot;</span>
        <span class="k">return</span> <span class="n">var</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_decls</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">decls</span><span class="p">:</span> <span class="n">cabc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">expose_value</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">decls</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">expose_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument is marked as exposed, but does not have a name.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">decls</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">arg</span> <span class="o">=</span> <span class="n">decls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Arguments take exactly one parameter declaration, got&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">decls</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">decls</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="p">[</span><span class="n">arg</span><span class="p">],</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_usage_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">make_metavar</span><span class="p">(</span><span class="n">ctx</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_error_hint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_metavar</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">_OptionParser</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nargs</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;BaseCommand&quot;</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;&#39;BaseCommand&#39; is deprecated and will be removed in Click 9.0. Use&quot;</span>
            <span class="s2">&quot; &#39;Command&#39; instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_BaseCommand</span>

    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;MultiCommand&quot;</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;&#39;MultiCommand&#39; is deprecated and will be removed in Click 9.0. Use&quot;</span>
            <span class="s2">&quot; &#39;Group&#39; instead.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_MultiCommand</span>

    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Kevin Deldycke and contributors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2026-02-21</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=c403aa1a"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs";





const initStyles = () => {
    const defaultStyle = document.createElement('style');
    defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}`;
    document.head.appendChild(defaultStyle);

    const fullscreenStyle = document.createElement('style');
    fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
    document.head.appendChild(fullscreenStyle);
}

// Detect if page has dark background
const isDarkTheme = () => {
    // We use a set of heuristics:
    // 1. Check for common dark mode classes or attributes
    // 2. Check computed background color brightness
    if (document.documentElement.classList.contains('dark') ||
        document.documentElement.getAttribute('data-theme') === 'dark' ||
        document.body.classList.contains('dark') ||
        document.body.getAttribute('data-theme') === 'dark') {
        // console.log("Dark theme detected via class/attribute");
        return true;
    }
    if (document.documentElement.classList.contains('light') ||
        document.documentElement.getAttribute('data-theme') === 'light' ||
        document.body.classList.contains('light') ||
        document.body.getAttribute('data-theme') === 'light') {
        // console.log("Light theme detected via class/attribute");
        return false;
    }
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        // console.log("Dark theme detected via prefers-color-scheme");
        return true;
    }
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        // console.log("Background color brightness:", brightness);
        return brightness < 128;
    }
    // console.log("No dark or light theme detected, defaulting to light theme");
    return false;
};

let darkTheme = isDarkTheme();
let modal = null;
let modalContent = null;
let previousScrollOffset = [window.scrollX, window.scrollY];

const runMermaid = async (rerun) => {
    console.log("Running mermaid diagrams, rerun =", rerun);
    // clear all existing mermaid charts
    let all_mermaids = document.querySelectorAll(".mermaid");

    if (rerun) {
        all_mermaids.forEach((el) => {
            if(!el.hasAttribute("data-original-code")) {
                // store original code
                // console.log(`Storing original code for first run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
            if(el.getAttribute("data-processed") === "true") {
                // remove and restore original
                el.removeAttribute("data-processed");
                // console.log(`Restoring original code for re-run: `, el.getAttribute('data-original-code'));
                el.innerHTML = el.getAttribute('data-original-code');
            } else {
                // store original code
                // console.log(`Storing original code for re-run: `, el.innerHTML);
                el.setAttribute('data-original-code', el.innerHTML);
            }
        });
        await mermaid.run();
    }

    all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("True" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll(".mermaid svg");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(() => runMermaid(false), 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(() => runMermaid(false), 200);
        return;
    }

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    if (modal !== null ) {
        // Destroy existing modal
        modal.remove();
        modal = null;
        modalContent = null;
    }

    modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">‚úï</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            // Already processed, adjust button class if needed
            const existingBtn = mermaidDiv.parentNode.querySelector('.mermaid-fullscreen-btn');
            if (existingBtn) {
                existingBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
            }
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '‚õ∂';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("True" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
        container.appendChild(fullscreenBtn);
    });
};

const load = async () => {
    initStyles();

    await runMermaid(true);

    const reRunIfThemeChanges = async () => {
        const newDarkTheme = isDarkTheme();
        if (newDarkTheme !== darkTheme) {
            darkTheme = newDarkTheme;
            console.log("Theme change detected, re-running mermaid with", darkTheme ? "dark" : "default", "theme");
            await mermaid.initialize(
                {...JSON.parse(
                    `{"startOnLoad": false}`
                ),
                ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
                }
            );
            await runMermaid(true);
        }
    };

    // Update theme classes when theme changes
    const themeObserver = new MutationObserver(reRunIfThemeChanges);
    themeObserver.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    themeObserver.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
};





console.log("Initializing mermaid with", darkTheme ? "dark" : "default", "theme");
mermaid.initialize(
    {...JSON.parse(
        `{"startOnLoad": false}`
    ),
    ...{ darkMode: darkTheme, theme: darkTheme ? 'dark' : 'default' },
    }
);

window.addEventListener("load", load);</script>
    </body>
</html>