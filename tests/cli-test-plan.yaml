# This test plan checks some high-level behavior of the click-extra CLI.


# Check click-extra is reporting the correct version of itself.
- cli_parameters: --version
  exit_code: 0
  stdout_contains: "\x1b[97mclick-extra\x1b[0m, version \x1b[32m"
  stdout_regex_fullmatch: "\x1b\\[97mclick-extra\x1b\\[0m, version \x1b\\[32m(None|[0-9]+\\.[0-9]+\\.[0-9]+)\x1b\\[0m\n"


# Test combination of version and verbosity.
- cli_parameters:
    - --verbosity
    - DEBUG
    - --version
  exit_code: 0
  stdout_contains: ", version"
  stdout_regex_matches: "\x1b\\[97mclick-extra\x1b\\[0m, version "
  stderr_contains:
    - "Set <RootLogger root (DEBUG)> to DEBUG."
    - "\x1b[34mdebug\x1b[0m: {prog_name}      : \x1b[97mclick-extra\x1b[0m\n"
  stderr_regex_matches:
    - "\x1b\\[34mdebug\x1b\\[0m: {prog_name}      : \x1b\\[97mclick-extra\x1b\\[0m\n"


# Test help output.
- cli_parameters:
    - --help
  strip_ansi: true
  stdout_contains:
    # yamllint disable rule:line-length
    - |
      Usage: click-extra [OPTIONS] COMMAND [ARGS]...

      Options:
        --time / --no-time    Measure and print elapsed execution time.  [default:
                              no-time]
        --color, --ansi / --no-color, --no-ansi
                              Strip out all colors and all ANSI codes from output.
                              [default: color]
        --config CONFIG_PATH  Location of the configuration file. Supports glob
                              pattern of local path and remote URL.  [default:
                              ~/Library/Application Support/click-extra/*.toml|*.yaml
                              |*.yml|*.json|*.json5|*.jsonc|*.hjson|*.ini|*.xml]
        --no-config           Ignore all configuration files and only use command
                              line parameters and environment variables.
        --show-params         Show all CLI parameters, their provenance, defaults and
                              value, then exit.
        --table-format [asciidoc|csv|csv-excel|csv-excel-tab|csv-unix|double-grid|double-outline|fancy-grid|fancy-outline|github|grid|heavy-grid|heavy-outline|html|jira|latex|latex-booktabs|latex-longtable|latex-raw|mediawiki|mixed-grid|mixed-outline|moinmoin|orgtbl|outline|pipe|plain|presto|pretty|psql|rounded-grid|rounded-outline|rst|simple|simple-grid|simple-outline|textile|tsv|unsafehtml|vertical|youtrack]
                              Rendering style of tables.  [default: rounded-outline]
        --verbosity LEVEL     Either CRITICAL, ERROR, WARNING, INFO, DEBUG.
                              [default: WARNING]
        -v, --verbose         Increase the default WARNING verbosity by one level for
                              each additional repetition of the option.  [default: 0]
        --version             Show the version and exit.
        -h, --help            Show this message and exit.
    # yamllint enable rule:line-length